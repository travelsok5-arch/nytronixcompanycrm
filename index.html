<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Nytronix - Professional CRM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #1e40af;
            --secondary: #f59e0b;
            --dark: #0f172a;
            --light: #f8fafc;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .gradient-bg {
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #1e40af 100%);
        }

        .sidebar-gradient {
            background: linear-gradient(180deg, #1e3a8a 0%, #1e40af 100%);
        }

        .hover-lift {
            transition: all 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-new {
            background: #3b82f6;
            color: white;
        }

        .status-contacted {
            background: #8b5cf6;
            color: white;
        }

        .status-qualified {
            background: #10b981;
            color: white;
        }

        .status-proposal {
            background: #f59e0b;
            color: white;
        }

        .status-closed {
            background: #6b7280;
            color: white;
        }

        .priority-high {
            background: #ef4444;
            color: white;
        }

        .priority-medium {
            background: #f59e0b;
            color: white;
        }

        .priority-low {
            background: #10b981;
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            position: relative;
        }

        .close-modal {
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: background-color 0.3s;
        }

        .close-modal:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .chat-message {
            max-width: 70%;
            margin-bottom: 16px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .notification-dot {
            width: 8px;
            height: 8px;
            background: #ef4444;
            border-radius: 50%;
            position: absolute;
            top: -2px;
            right: -2px;
        }

        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .profile-pic {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        /* Hide Tailwind warning */
        .cdn-warning {
            display: none !important;
        }

        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }

        .slide-in-right {
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .progress-bar {
            width: 100%;
            background-color: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 8px;
            background-color: #10b981;
            transition: width 0.3s ease;
        }

        /* Responsive improvements */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                z-index: 40;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .modal-content {
                margin: 10% auto;
                width: 95%;
            }

            .chat-message {
                max-width: 85%;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            .dark\:bg-gray-900 {
                background-color: #111827;
            }

            .dark\:text-white {
                color: white;
            }
        }
    </style>
</head>

<body class="bg-gray-50 font-sans">
    <!-- Login Page -->
    <div id="loginPage" class="min-h-screen flex items-center justify-center gradient-bg">
        <div class="glass-effect p-8 rounded-2xl shadow-2xl w-full max-w-md mx-4 border border-white/20">
            <div class="text-center mb-8">
                <div class="flex justify-center mb-4">
                    <div class="w-20 h-20 bg-white rounded-2xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-shield-alt text-3xl text-blue-600"></i>
                    </div>
                </div>
                <h1 class="text-4xl font-bold text-white mb-2">Cyber Nytronix</h1>
                <p class="text-blue-200 text-lg">Professional CRM System</p>
            </div>
            <form id="loginForm">
                <div class="mb-6">
                    <label class="block text-white text-sm font-semibold mb-3" for="email">
                        <i class="fas fa-envelope mr-2"></i>Email Address
                    </label>
                    <input
                        class="w-full px-4 py-3 rounded-xl border border-white/30 bg-white/10 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-300"
                        id="email" type="email" placeholder="Enter your email" required>
                </div>
                <div class="mb-6">
                    <label class="block text-white text-sm font-semibold mb-3" for="password">
                        <i class="fas fa-lock mr-2"></i>Password
                    </label>
                    <input
                        class="w-full px-4 py-3 rounded-xl border border-white/30 bg-white/10 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-300"
                        id="password" type="password" placeholder="Enter your password" required>
                </div>
                <button
                    class="w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg"
                    type="submit" id="loginBtn">
                    <i class="fas fa-sign-in-alt mr-2"></i>Sign In to Dashboard
                </button>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="hidden">
        <!-- Top Navigation -->
        <nav class="bg-white shadow-lg border-b border-gray-200 sticky top-0 z-50">
            <div class="px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <button id="toggleSidebar"
                            class="text-gray-600 hover:text-blue-600 transition-colors duration-300">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                        <div class="flex items-center space-x-3">
                            <div
                                class="w-10 h-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg">
                                <i class="fas fa-shield-alt text-white text-lg"></i>
                            </div>
                            <div>
                                <h1 class="text-xl font-bold text-gray-800">Cyber Nytronix CRM</h1>
                                <p class="text-sm text-gray-600" id="welcomeMessage">Welcome back!</p>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center space-x-4">
                        <!-- Notification Bell -->
                        <div class="relative">
                            <button id="notificationBtn" class="text-gray-600 hover:text-blue-600 transition-colors duration-300 relative">
                                <i class="fas fa-bell text-xl"></i>
                                <span id="notificationCount" class="notification-dot hidden"></span>
                            </button>
                            <div id="notificationDropdown" class="hidden absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 py-1 z-50">
                                <div class="px-4 py-2 border-b border-gray-200">
                                    <h3 class="font-semibold text-gray-800">Notifications</h3>
                                </div>
                                <div class="max-h-64 overflow-y-auto" id="notificationList">
                                    <!-- Notifications will be populated here -->
                                </div>
                                <div class="px-4 py-2 border-t border-gray-200 text-center">
                                    <button id="clearNotifications" class="text-sm text-blue-600 hover:text-blue-800">Clear All</button>
                                </div>
                            </div>
                        </div>

                        <!-- User Profile -->
                        <div class="relative">
                            <button id="profileDropdownBtn"
                                class="flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 transition-colors duration-300">
                                <img id="userProfilePic"
                                    src="https://ui-avatars.com/api/?name=Admin&background=1e40af&color=fff"
                                    alt="Profile" class="profile-pic border-2 border-blue-500">
                                <div class="text-left">
                                    <div class="font-semibold text-gray-800" id="userName">Admin</div>
                                    <div class="text-sm text-gray-600" id="userRole">Administrator</div>
                                </div>
                                <i class="fas fa-chevron-down text-gray-400 text-sm"></i>
                            </button>

                            <!-- Profile Dropdown -->
                            <div id="profileDropdown"
                                class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 py-1 z-50">
                                <a href="#"
                                    class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors duration-300"
                                    id="profileLink">
                                    <i class="fas fa-user mr-2"></i>My Profile
                                </a>
                                <div class="border-t border-gray-200 my-1"></div>
                                <a href="#"
                                    class="block px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors duration-300"
                                    id="logoutLink">
                                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <div class="flex">
            <!-- Sidebar -->
            <div id="sidebar"
                class="sidebar-gradient text-white w-64 min-h-screen py-6 shadow-xl transition-all duration-300">
                <div class="px-6 mb-8">
                    <h2 class="text-lg font-bold text-white/80 uppercase tracking-wider">Navigation</h2>
                </div>

                <nav class="space-y-1 px-3">
                    <a href="#"
                        class="tab-link flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all duration-300 active"
                        data-tab="dashboard">
                        <i class="fas fa-tachometer-alt mr-3 text-lg text-blue-200"></i>
                        <span class="font-medium">Dashboard</span>
                    </a>

                    <a href="#"
                        class="tab-link flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all duration-300"
                        data-tab="leads">
                        <i class="fas fa-users mr-3 text-lg text-green-200"></i>
                        <span class="font-medium">Leads Management</span>
                    </a>

                    <a href="#"
                        class="tab-link flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all duration-300"
                        data-tab="clients">
                        <i class="fas fa-user-tie mr-3 text-lg text-purple-200"></i>
                        <span class="font-medium">Clients</span>
                    </a>

                    <a href="#"
                        class="tab-link flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all duration-300"
                        data-tab="projects">
                        <i class="fas fa-project-diagram mr-3 text-lg text-indigo-200"></i>
                        <span class="font-medium">Projects</span>
                    </a>

                    <a href="#"
                        class="tab-link flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all duration-300"
                        data-tab="tasks">
                        <i class="fas fa-tasks mr-3 text-lg text-orange-200"></i>
                        <span class="font-medium">Tasks</span>
                    </a>

                    <a href="#"
                        class="tab-link flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all duration-300"
                        data-tab="tickets">
                        <i class="fas fa-ticket-alt mr-3 text-lg text-yellow-200"></i>
                        <span class="font-medium">Tickets</span>
                    </a>

                    <a href="#"
                        class="tab-link flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all duration-300"
                        data-tab="security">
                        <i class="fas fa-shield-alt mr-3 text-lg text-red-200"></i>
                        <span class="font-medium">Security</span>
                    </a>

                    <a href="#"
                        class="tab-link flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all duration-300"
                        data-tab="teamChat">
                        <i class="fas fa-comments mr-3 text-lg text-teal-200"></i>
                        <span class="font-medium">Team Chat</span>
                    </a>

                    <a href="#"
                        class="tab-link flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all duration-300"
                        data-tab="users" id="usersTab">
                        <i class="fas fa-users-cog mr-3 text-lg text-yellow-200"></i>
                        <span class="font-medium">User Management</span>
                    </a>

                    <a href="#"
                        class="tab-link flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all duration-300"
                        data-tab="systemLogs" id="systemLogsTab">
                        <i class="fas fa-clipboard-list mr-3 text-lg text-gray-200"></i>
                        <span class="font-medium">System Logs</span>
                    </a>

                    <a href="#"
                        class="tab-link flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all duration-300"
                        data-tab="backup" id="backupTab">
                        <i class="fas fa-database mr-3 text-lg text-blue-200"></i>
                        <span class="font-medium">Backup & Restore</span>
                    </a>
                </nav>

                <div class="mt-8 px-6">
                    <div class="bg-white/10 rounded-xl p-4 border border-white/20">
                        <div class="flex items-center mb-2">
                            <i class="fas fa-database text-blue-200 mr-2"></i>
                            <span class="font-medium text-white">System Status</span>
                        </div>
                        <div class="space-y-1 text-sm text-blue-100">
                            <div class="flex justify-between">
                                <span>Database:</span>
                                <span class="text-green-300">Online</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Users Online:</span>
                                <span id="onlineUsersCount">1</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Last Backup:</span>
                                <span id="lastBackupTime">Today</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div id="contentArea" class="flex-1 p-6 transition-all duration-300">
                <!-- Dashboard Tab -->
                <div id="dashboard" class="tab-content active">
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Dashboard Overview</h2>
                        <p class="text-gray-600">Welcome to your Cyber Nytronix CRM dashboard</p>
                    </div>

                    <!-- Stats Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-2xl shadow-lg p-6 border-l-4 border-blue-500 hover-lift">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-semibold text-gray-600 uppercase tracking-wide">Total Leads
                                    </p>
                                    <p class="text-3xl font-bold text-gray-800 mt-2" id="totalLeads">0</p>
                                </div>
                                <div class="p-3 bg-blue-100 rounded-xl">
                                    <i class="fas fa-users text-blue-600 text-2xl"></i>
                                </div>
                            </div>
                            <div class="mt-4 flex items-center text-sm text-green-600">
                                <i class="fas fa-arrow-up mr-1"></i>
                                <span>Active pipeline</span>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow-lg p-6 border-l-4 border-green-500 hover-lift">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-semibold text-gray-600 uppercase tracking-wide">Active
                                        Clients</p>
                                    <p class="text-3xl font-bold text-gray-800 mt-2" id="activeClients">0</p>
                                </div>
                                <div class="p-3 bg-green-100 rounded-xl">
                                    <i class="fas fa-user-tie text-green-600 text-2xl"></i>
                                </div>
                            </div>
                            <div class="mt-4 flex items-center text-sm text-green-600">
                                <i class="fas fa-chart-line mr-1"></i>
                                <span>Growing</span>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow-lg p-6 border-l-4 border-purple-500 hover-lift">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-semibold text-gray-600 uppercase tracking-wide">Pending Tasks
                                    </p>
                                    <p class="text-3xl font-bold text-gray-800 mt-2" id="pendingTasks">0</p>
                                </div>
                                <div class="p-3 bg-purple-100 rounded-xl">
                                    <i class="fas fa-tasks text-purple-600 text-2xl"></i>
                                </div>
                            </div>
                            <div class="mt-4 flex items-center text-sm text-orange-600">
                                <i class="fas fa-clock mr-1"></i>
                                <span>Attention needed</span>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow-lg p-6 border-l-4 border-yellow-500 hover-lift">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-semibold text-gray-600 uppercase tracking-wide">Monthly
                                        Revenue</p>
                                    <p class="text-3xl font-bold text-gray-800 mt-2" id="monthlyRevenue">$0</p>
                                </div>
                                <div class="p-3 bg-yellow-100 rounded-xl">
                                    <i class="fas fa-dollar-sign text-yellow-600 text-2xl"></i>
                                </div>
                            </div>
                            <div class="mt-4 flex items-center text-sm text-green-600">
                                <i class="fas fa-trending-up mr-1"></i>
                                <span>On track</span>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Section -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Leads by Status</h3>
                            <div class="h-64">
                                <canvas id="leadsChart"></canvas>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Revenue Trend</h3>
                            <div class="h-64">
                                <canvas id="revenueChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity & Quick Actions -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Recent Leads</h3>
                            <div class="space-y-4" id="recentLeads">
                                <!-- Recent leads will be loaded here -->
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Quick Actions</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <button onclick="showTab('leads')"
                                    class="bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-xl transition-all duration-300 transform hover:scale-105 flex flex-col items-center justify-center">
                                    <i class="fas fa-plus text-2xl mb-2"></i>
                                    <span class="text-sm font-medium">Add Lead</span>
                                </button>
                                <button onclick="showTab('clients')"
                                    class="bg-green-500 hover:bg-green-600 text-white p-4 rounded-xl transition-all duration-300 transform hover:scale-105 flex flex-col items-center justify-center">
                                    <i class="fas fa-user-plus text-2xl mb-2"></i>
                                    <span class="text-sm font-medium">Add Client</span>
                                </button>
                                <button onclick="showTab('projects')"
                                    class="bg-purple-500 hover:bg-purple-600 text-white p-4 rounded-xl transition-all duration-300 transform hover:scale-105 flex flex-col items-center justify-center">
                                    <i class="fas fa-project-diagram text-2xl mb-2"></i>
                                    <span class="text-sm font-medium">New Project</span>
                                </button>
                                <button onclick="showTab('tickets')"
                                    class="bg-orange-500 hover:bg-orange-600 text-white p-4 rounded-xl transition-all duration-300 transform hover:scale-105 flex flex-col items-center justify-center">
                                    <i class="fas fa-ticket-alt text-2xl mb-2"></i>
                                    <span class="text-sm font-medium">Create Ticket</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Leads Management Tab -->
                <div id="leads" class="tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-3xl font-bold text-gray-800 mb-2">Leads Management</h2>
                            <p class="text-gray-600">Manage and track your sales leads</p>
                        </div>
                        <button
                            class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg"
                            id="addLeadBtn">
                            <i class="fas fa-plus mr-2"></i>Add New Lead
                        </button>
                    </div>

                    <!-- Leads Table -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-800">All Leads</h3>
                                <div class="flex space-x-3">
                                    <div class="relative">
                                        <input type="text" placeholder="Search leads..."
                                            class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            id="searchLeads">
                                        <div
                                            class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <i class="fas fa-search text-gray-400"></i>
                                        </div>
                                    </div>
                                    <select
                                        class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        id="statusFilter">
                                        <option value="">All Status</option>
                                        <option value="new">New</option>
                                        <option value="contacted">Contacted</option>
                                        <option value="qualified">Qualified</option>
                                        <option value="proposal">Proposal</option>
                                        <option value="closed">Closed</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Lead</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Contact</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Source</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Status</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Value</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="leadsTableBody">
                                    <!-- Leads will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        <div class="px-6 py-4 border-t border-gray-200 bg-gray-50">
                            <div class="flex justify-between items-center">
                                <div class="text-sm text-gray-700">
                                    Showing <span class="font-semibold" id="leadsCount">0</span> leads
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add Lead Modal -->
                <div id="addLeadModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Add New Lead</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="addLeadModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="addLeadForm" class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" id="leadName"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Company</label>
                                    <input type="text" id="leadCompany"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Email Address *</label>
                                    <input type="email" id="leadEmail"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                    <input type="text" id="leadPhone"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Source</label>
                                    <select id="leadSource"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="website">Website</option>
                                        <option value="referral">Referral</option>
                                        <option value="social">Social Media</option>
                                        <option value="advertising">Advertising</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="leadStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="new">New</option>
                                        <option value="contacted">Contacted</option>
                                        <option value="qualified">Qualified</option>
                                        <option value="proposal">Proposal</option>
                                        <option value="closed">Closed</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Priority</label>
                                    <select id="leadPriority"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="low">Low</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="high">High</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Estimated Value
                                        ($)</label>
                                    <input type="number" id="leadValue"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        value="0" step="0.01">
                                </div>
                            </div>
                            <div class="mt-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Notes</label>
                                <textarea id="leadNotes" rows="3"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="addLeadModal">
                                    Cancel
                                </button>
                                <button type="submit" id="submitLeadBtn"
                                    class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all duration-300">
                                    Add Lead
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Clients Management Tab -->
                <div id="clients" class="tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-3xl font-bold text-gray-800 mb-2">Clients Management</h2>
                            <p class="text-gray-600">Manage your client relationships and contracts</p>
                        </div>
                        <button
                            class="bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg"
                            id="addClientBtn">
                            <i class="fas fa-plus mr-2"></i>Add New Client
                        </button>
                    </div>

                    <!-- Clients Table -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Client</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Contact</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Services</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Status</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Contract Value</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="clientsTableBody">
                                    <!-- Clients will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Add Client Modal -->
                <div id="addClientModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Add New Client</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="addClientModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="addClientForm" class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" id="clientName"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Company *</label>
                                    <input type="text" id="clientCompany"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Email Address *</label>
                                    <input type="email" id="clientEmail"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                    <input type="text" id="clientPhone"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                                    <input type="text" id="clientAddress"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Website</label>
                                    <input type="text" id="clientWebsite"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Industry</label>
                                    <input type="text" id="clientIndustry"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Services</label>
                                    <textarea id="clientServices" rows="2"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Contract Value
                                        ($)</label>
                                    <input type="number" id="clientContractValue"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        value="0" step="0.01">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="clientStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                        <option value="suspended">Suspended</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mt-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Notes</label>
                                <textarea id="clientNotes" rows="3"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="addClientModal">
                                    Cancel
                                </button>
                                <button type="submit" id="submitClientBtn"
                                    class="px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all duration-300">
                                    Add Client
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Projects Management Tab -->
                <div id="projects" class="tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-3xl font-bold text-gray-800 mb-2">Projects Management</h2>
                            <p class="text-gray-600">Manage your projects and track progress</p>
                        </div>
                        <button
                            class="bg-purple-500 hover:bg-purple-600 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg"
                            id="addProjectBtn">
                            <i class="fas fa-plus mr-2"></i>Add New Project
                        </button>
                    </div>

                    <!-- Projects Table -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Project</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Client</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Status</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Progress</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Budget</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="projectsTableBody">
                                    <!-- Projects will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Add Project Modal -->
                <div id="addProjectModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Add New Project</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="addProjectModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="addProjectForm" class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Project Name *</label>
                                    <input type="text" id="projectName"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                    <textarea id="projectDescription" rows="3"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Client *</label>
                                    <select id="projectClient"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                        <option value="">Select Client</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="projectStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="planning">Planning</option>
                                        <option value="in_progress">In Progress</option>
                                        <option value="on_hold">On Hold</option>
                                        <option value="completed">Completed</option>
                                        <option value="cancelled">Cancelled</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Priority</label>
                                    <select id="projectPriority"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="low">Low</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="high">High</option>
                                        <option value="critical">Critical</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Assigned To</label>
                                    <select id="projectAssignedTo"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="">Unassigned</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Start Date</label>
                                    <input type="date" id="projectStartDate"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">End Date</label>
                                    <input type="date" id="projectEndDate"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Budget ($)</label>
                                    <input type="number" id="projectBudget"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        value="0" step="0.01">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Progress (%)</label>
                                    <input type="number" id="projectProgress"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        value="0" min="0" max="100">
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="addProjectModal">
                                    Cancel
                                </button>
                                <button type="submit" id="submitProjectBtn"
                                    class="px-6 py-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-all duration-300">
                                    Add Project
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Tasks Management Tab -->
                <div id="tasks" class="tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-3xl font-bold text-gray-800 mb-2">Tasks Management</h2>
                            <p class="text-gray-600">Manage and track your tasks</p>
                        </div>
                        <button
                            class="bg-orange-500 hover:bg-orange-600 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg"
                            id="addTaskBtn">
                            <i class="fas fa-plus mr-2"></i>Add New Task
                        </button>
                    </div>

                    <!-- Tasks Table -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Task</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Project</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Assigned To</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Status</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Due Date</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="tasksTableBody">
                                    <!-- Tasks will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Add Task Modal -->
                <div id="addTaskModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Add New Task</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="addTaskModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="addTaskForm" class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Task Title *</label>
                                    <input type="text" id="taskTitle"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                    <textarea id="taskDescription" rows="3"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Project *</label>
                                    <select id="taskProject"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                        <option value="">Select Project</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Assigned To</label>
                                    <select id="taskAssignedTo"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="">Unassigned</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="taskStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="pending">Pending</option>
                                        <option value="in_progress">In Progress</option>
                                        <option value="completed">Completed</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Priority</label>
                                    <select id="taskPriority"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="low">Low</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="high">High</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Due Date</label>
                                    <input type="date" id="taskDueDate"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Estimated Hours</label>
                                    <input type="number" id="taskEstimatedHours"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        value="0" step="0.5">
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="addTaskModal">
                                    Cancel
                                </button>
                                <button type="submit" id="submitTaskBtn"
                                    class="px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-all duration-300">
                                    Add Task
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Tickets Management Tab -->
                <div id="tickets" class="tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-3xl font-bold text-gray-800 mb-2">Tickets Management</h2>
                            <p class="text-gray-600">Manage support tickets and client requests</p>
                        </div>
                        <button
                            class="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg"
                            id="addTicketBtn">
                            <i class="fas fa-plus mr-2"></i>Create New Ticket
                        </button>
                    </div>

                    <!-- Tickets Table -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Ticket</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Client</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Type</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Priority</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Status</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="ticketsTableBody">
                                    <!-- Tickets will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Add Ticket Modal -->
                <div id="addTicketModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Create New Ticket</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="addTicketModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="addTicketForm" class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Ticket Title *</label>
                                    <input type="text" id="ticketTitle"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                    <textarea id="ticketDescription" rows="3"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Client *</label>
                                    <select id="ticketClient"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                        <option value="">Select Client</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Type</label>
                                    <select id="ticketType"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="technical_support">Technical Support</option>
                                        <option value="billing">Billing</option>
                                        <option value="feature_request">Feature Request</option>
                                        <option value="bug_report">Bug Report</option>
                                        <option value="general_inquiry">General Inquiry</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Priority</label>
                                    <select id="ticketPriority"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="low">Low</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="high">High</option>
                                        <option value="urgent">Urgent</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="ticketStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="open">Open</option>
                                        <option value="in_progress">In Progress</option>
                                        <option value="resolved">Resolved</option>
                                        <option value="closed">Closed</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Assigned To</label>
                                    <select id="ticketAssignedTo"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="">Unassigned</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="addTicketModal">
                                    Cancel
                                </button>
                                <button type="submit" id="submitTicketBtn"
                                    class="px-6 py-3 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-all duration-300">
                                    Create Ticket
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Security Management Tab -->
                <div id="security" class="tab-content">
                    <div class="mb-6">
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Security Management</h2>
                        <p class="text-gray-600">Monitor vulnerabilities, incidents, and security alerts</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Vulnerabilities</h3>
                            <div class="space-y-4" id="vulnerabilitiesList">
                                <!-- Vulnerabilities will be populated here -->
                            </div>
                            <button
                                class="w-full mt-4 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg transition-all duration-300"
                                id="addVulnerabilityBtn">
                                <i class="fas fa-plus mr-2"></i>Add Vulnerability
                            </button>
                        </div>

                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Incidents</h3>
                            <div class="space-y-4" id="incidentsList">
                                <!-- Incidents will be populated here -->
                            </div>
                            <button
                                class="w-full mt-4 bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg transition-all duration-300"
                                id="addIncidentBtn">
                                <i class="fas fa-plus mr-2"></i>Report Incident
                            </button>
                        </div>

                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Security Alerts</h3>
                            <div class="space-y-4" id="alertsList">
                                <!-- Alerts will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add Vulnerability Modal -->
                <div id="addVulnerabilityModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Add Vulnerability</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="addVulnerabilityModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="addVulnerabilityForm" class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Title *</label>
                                    <input type="text" id="vulnerabilityTitle"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                    <textarea id="vulnerabilityDescription" rows="3"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Severity</label>
                                    <select id="vulnerabilitySeverity"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="low">Low</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="high">High</option>
                                        <option value="critical">Critical</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="vulnerabilityStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="open">Open</option>
                                        <option value="in_progress">In Progress</option>
                                        <option value="resolved">Resolved</option>
                                        <option value="closed">Closed</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Project</label>
                                    <select id="vulnerabilityProject"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="">Select Project</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Assigned To</label>
                                    <select id="vulnerabilityAssignedTo"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="">Unassigned</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">CVSS Score</label>
                                    <input type="number" id="vulnerabilityCvssScore"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        min="0" max="10" step="0.1">
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="addVulnerabilityModal">
                                    Cancel
                                </button>
                                <button type="submit" id="submitVulnerabilityBtn"
                                    class="px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-all duration-300">
                                    Add Vulnerability
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Add Incident Modal -->
                <div id="addIncidentModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Report Incident</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="addIncidentModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="addIncidentForm" class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Title *</label>
                                    <input type="text" id="incidentTitle"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                    <textarea id="incidentDescription" rows="3"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Severity</label>
                                    <select id="incidentSeverity"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="low">Low</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="high">High</option>
                                        <option value="critical">Critical</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="incidentStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="open">Open</option>
                                        <option value="investigating">Investigating</option>
                                        <option value="contained">Contained</option>
                                        <option value="resolved">Resolved</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Client</label>
                                    <select id="incidentClient"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="">Select Client</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Assigned To</label>
                                    <select id="incidentAssignedTo"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="">Unassigned</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="addIncidentModal">
                                    Cancel
                                </button>
                                <button type="submit" id="submitIncidentBtn"
                                    class="px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-all duration-300">
                                    Report Incident
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- User Management Tab -->
                <div id="users" class="tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-3xl font-bold text-gray-800 mb-2">User Management</h2>
                            <p class="text-gray-600">Manage system users and permissions</p>
                        </div>
                        <button
                            class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg"
                            id="addUserBtn">
                            <i class="fas fa-plus mr-2"></i>Add New User
                        </button>
                    </div>

                    <!-- Users Table -->
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            User</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Role</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Department</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Status</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Last Login</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="usersTableBody">
                                    <!-- Users will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Add User Modal -->
                <div id="addUserModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Add New User</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="addUserModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="addUserForm" class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" id="userNameInput"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Email Address *</label>
                                    <input type="email" id="userEmail"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Password *</label>
                                    <input type="password" id="userPassword"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Role</label>
                                    <select id="userRoleSelect"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="user">User</option>
                                        <option value="admin">Administrator</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Department</label>
                                    <input type="text" id="userDepartment"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Position</label>
                                    <input type="text" id="userPosition"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                    <input type="text" id="userPhone"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="userStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="addUserModal">
                                    Cancel
                                </button>
                                <button type="submit" id="submitUserBtn"
                                    class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all duration-300">
                                    Add User
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Team Chat Tab -->
                <div id="teamChat" class="tab-content">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6">Team Chat</h2>

                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                        <div class="grid grid-cols-1 md:grid-cols-4">
                            <!-- Online Users -->
                            <div class="md:col-span-1 border-r border-gray-200">
                                <div class="p-4 border-b border-gray-200">
                                    <h3 class="font-semibold text-gray-800">Team Members</h3>
                                </div>
                                <div class="p-4">
                                    <ul class="space-y-3" id="onlineUsersList">
                                        <!-- Online users will be populated here -->
                                    </ul>
                                </div>
                            </div>

                            <!-- Chat Area -->
                            <div class="md:col-span-3">
                                <div class="p-4 border-b border-gray-200">
                                    <h3 class="font-semibold text-gray-800">General Chat</h3>
                                </div>
                                <div class="p-4 h-96 overflow-y-auto" id="chatMessages">
                                    <!-- Chat messages will be populated here -->
                                </div>
                                <div class="p-4 border-t border-gray-200">
                                    <div class="flex space-x-3">
                                        <input type="text" placeholder="Type your message..."
                                            class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                            id="messageInput">
                                        <button
                                            class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-all duration-300 transform hover:scale-105"
                                            id="sendMessageBtn">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reports Tab -->
                <div id="reports" class="tab-content">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6">Reports & Analytics</h2>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Performance Metrics</h3>
                            <div class="space-y-4">
                                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                    <span class="text-gray-700">Lead Conversion Rate</span>
                                    <span class="font-semibold text-green-600">24%</span>
                                </div>
                                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                    <span class="text-gray-700">Project Completion Rate</span>
                                    <span class="font-semibold text-blue-600">78%</span>
                                </div>
                                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                    <span class="text-gray-700">Ticket Resolution Time</span>
                                    <span class="font-semibold text-orange-600">2.3 days</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Revenue Analytics</h3>
                            <div class="h-64">
                                <canvas id="revenueAnalyticsChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- System Logs Tab -->
                <div id="systemLogs" class="tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-3xl font-bold text-gray-800">System Logs</h2>
                        <button
                            class="bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300"
                            id="refreshLogsBtn">
                            <i class="fas fa-sync-alt mr-2"></i>Refresh Logs
                        </button>
                    </div>

                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            User</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Action</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Description</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            IP Address</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Timestamp</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="systemLogsTableBody">
                                    <!-- System logs will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Edit Lead Modal -->
                <div id="editLeadModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Edit Lead</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="editLeadModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="editLeadForm" class="p-6">
                            <input type="hidden" id="editLeadId">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" id="editLeadName"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Company</label>
                                    <input type="text" id="editLeadCompany"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Email Address *</label>
                                    <input type="email" id="editLeadEmail"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                    <input type="text" id="editLeadPhone"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Source</label>
                                    <select id="editLeadSource"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="website">Website</option>
                                        <option value="referral">Referral</option>
                                        <option value="social">Social Media</option>
                                        <option value="advertising">Advertising</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="editLeadStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="new">New</option>
                                        <option value="contacted">Contacted</option>
                                        <option value="qualified">Qualified</option>
                                        <option value="proposal">Proposal</option>
                                        <option value="closed">Closed</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Priority</label>
                                    <select id="editLeadPriority"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="low">Low</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="high">High</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Estimated Value
                                        ($)</label>
                                    <input type="number" id="editLeadValue"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        value="0" step="0.01">
                                </div>
                            </div>
                            <div class="mt-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Notes</label>
                                <textarea id="editLeadNotes" rows="3"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="editLeadModal">
                                    Cancel
                                </button>
                                <button type="submit" id="updateLeadBtn"
                                    class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all duration-300">
                                    Update Lead
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Edit Client Modal -->
                <div id="editClientModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Edit Client</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="editClientModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="editClientForm" class="p-6">
                            <input type="hidden" id="editClientId">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" id="editClientName"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Company *</label>
                                    <input type="text" id="editClientCompany"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Email Address *</label>
                                    <input type="email" id="editClientEmail"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                    <input type="text" id="editClientPhone"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                                    <input type="text" id="editClientAddress"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Website</label>
                                    <input type="text" id="editClientWebsite"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Industry</label>
                                    <input type="text" id="editClientIndustry"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Services</label>
                                    <textarea id="editClientServices" rows="2"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Contract Value
                                        ($)</label>
                                    <input type="number" id="editClientContractValue"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        value="0" step="0.01">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="editClientStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                        <option value="suspended">Suspended</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mt-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Notes</label>
                                <textarea id="editClientNotes" rows="3"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="editClientModal">
                                    Cancel
                                </button>
                                <button type="submit" id="updateClientBtn"
                                    class="px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all duration-300">
                                    Update Client
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Edit Project Modal -->
                <div id="editProjectModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Edit Project</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="editProjectModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="editProjectForm" class="p-6">
                            <input type="hidden" id="editProjectId">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Project Name *</label>
                                    <input type="text" id="editProjectName"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                    <textarea id="editProjectDescription" rows="3"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Client *</label>
                                    <select id="editProjectClient"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                        <option value="">Select Client</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="editProjectStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="planning">Planning</option>
                                        <option value="in_progress">In Progress</option>
                                        <option value="on_hold">On Hold</option>
                                        <option value="completed">Completed</option>
                                        <option value="cancelled">Cancelled</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Priority</label>
                                    <select id="editProjectPriority"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="low">Low</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="high">High</option>
                                        <option value="critical">Critical</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Assigned To</label>
                                    <select id="editProjectAssignedTo"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="">Unassigned</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Start Date</label>
                                    <input type="date" id="editProjectStartDate"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">End Date</label>
                                    <input type="date" id="editProjectEndDate"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Budget ($)</label>
                                    <input type="number" id="editProjectBudget"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        value="0" step="0.01">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Progress (%)</label>
                                    <input type="number" id="editProjectProgress"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        value="0" min="0" max="100">
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="editProjectModal">
                                    Cancel
                                </button>
                                <button type="submit" id="updateProjectBtn"
                                    class="px-6 py-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-all duration-300">
                                    Update Project
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Edit Task Modal -->
                <div id="editTaskModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Edit Task</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="editTaskModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="editTaskForm" class="p-6">
                            <input type="hidden" id="editTaskId">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Task Title *</label>
                                    <input type="text" id="editTaskTitle"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                    <textarea id="editTaskDescription" rows="3"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Project *</label>
                                    <select id="editTaskProject"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                        <option value="">Select Project</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Assigned To</label>
                                    <select id="editTaskAssignedTo"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="">Unassigned</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="editTaskStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="pending">Pending</option>
                                        <option value="in_progress">In Progress</option>
                                        <option value="completed">Completed</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Priority</label>
                                    <select id="editTaskPriority"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="low">Low</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="high">High</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Due Date</label>
                                    <input type="date" id="editTaskDueDate"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Estimated Hours</label>
                                    <input type="number" id="editTaskEstimatedHours"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        value="0" step="0.5">
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="editTaskModal">
                                    Cancel
                                </button>
                                <button type="submit" id="updateTaskBtn"
                                    class="px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-all duration-300">
                                    Update Task
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Edit Ticket Modal -->
                <div id="editTicketModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Edit Ticket</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="editTicketModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="editTicketForm" class="p-6">
                            <input type="hidden" id="editTicketId">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Ticket Title *</label>
                                    <input type="text" id="editTicketTitle"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                    <textarea id="editTicketDescription" rows="3"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Client *</label>
                                    <select id="editTicketClient"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                        <option value="">Select Client</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Type</label>
                                    <select id="editTicketType"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="technical_support">Technical Support</option>
                                        <option value="billing">Billing</option>
                                        <option value="feature_request">Feature Request</option>
                                        <option value="bug_report">Bug Report</option>
                                        <option value="general_inquiry">General Inquiry</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Priority</label>
                                    <select id="editTicketPriority"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="low">Low</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="high">High</option>
                                        <option value="urgent">Urgent</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="editTicketStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="open">Open</option>
                                        <option value="in_progress">In Progress</option>
                                        <option value="resolved">Resolved</option>
                                        <option value="closed">Closed</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Assigned To</label>
                                    <select id="editTicketAssignedTo"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="">Unassigned</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="editTicketModal">
                                    Cancel
                                </button>
                                <button type="submit" id="updateTicketBtn"
                                    class="px-6 py-3 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-all duration-300">
                                    Update Ticket
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Edit User Modal -->
                <div id="editUserModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Edit User</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="editUserModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="editUserForm" class="p-6">
                            <input type="hidden" id="editUserId">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" id="editUserName"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Email Address *</label>
                                    <input type="email" id="editUserEmail"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Role</label>
                                    <select id="editUserRole"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="user">User</option>
                                        <option value="admin">Administrator</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Department</label>
                                    <input type="text" id="editUserDepartment"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Position</label>
                                    <input type="text" id="editUserPosition"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                    <input type="text" id="editUserPhone"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                    <select id="editUserStatus"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="editUserModal">
                                    Cancel
                                </button>
                                <button type="submit" id="updateUserBtn"
                                    class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all duration-300">
                                    Update User
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Reset Password Modal -->
                <div id="resetPasswordModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Reset User Password</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="resetPasswordModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="resetPasswordForm" class="p-6">
                            <input type="hidden" id="resetPasswordUserId">
                            <div class="mb-4">
                                <p class="text-gray-700 mb-4">You are resetting password for: <span id="resetPasswordUserName" class="font-semibold"></span></p>
                            </div>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">New Password *</label>
                                    <input type="password" id="resetPasswordNewPassword"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Confirm New Password *</label>
                                    <input type="password" id="resetPasswordConfirmPassword"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                            </div>

                            <div class="mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                <div class="flex">
                                    <i class="fas fa-exclamation-triangle text-yellow-500 mt-1 mr-3"></i>
                                    <div>
                                        <h4 class="text-sm font-medium text-yellow-800">Password Requirements</h4>
                                        <ul class="mt-1 text-sm text-yellow-700 list-disc list-inside">
                                            <li>At least 8 characters long</li>
                                            <li>Contains uppercase and lowercase letters</li>
                                            <li>Includes numbers and special characters</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="resetPasswordModal">
                                    Cancel
                                </button>
                                <button type="submit" id="updatePasswordBtn"
                                    class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all duration-300">
                                    Reset Password
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Profile Modal -->
                <div id="profileModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">My Profile</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="profileModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="profileForm" class="p-6">
                            <div class="flex items-center space-x-6 mb-6">
                                <div class="relative">
                                    <img id="profileImage"
                                        src="https://ui-avatars.com/api/?name=Admin&background=1e40af&color=fff"
                                        alt="Profile" class="w-24 h-24 rounded-full border-4 border-blue-500">
                                    <input type="file" id="profileImageInput" accept="image/*" class="hidden">
                                    <button type="button" id="changeProfileImageBtn"
                                        class="absolute bottom-0 right-0 bg-blue-500 text-white p-2 rounded-full hover:bg-blue-600 transition-colors duration-300">
                                        <i class="fas fa-camera text-sm"></i>
                                    </button>
                                </div>
                                <div>
                                    <h4 class="text-xl font-semibold text-gray-800" id="profileName">Admin User</h4>
                                    <p class="text-gray-600" id="profileRole">Administrator</p>
                                    <p class="text-sm text-gray-500" id="profileEmail">admin@cybernytronix.com</p>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" id="profileFullName"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Email Address *</label>
                                    <input type="email" id="profileEmailInput"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                    <input type="text" id="profilePhone"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Department</label>
                                    <input type="text" id="profileDepartment"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Position</label>
                                    <input type="text" id="profilePosition"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Last Login</label>
                                    <input type="text" id="profileLastLogin"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50" readonly>
                                </div>
                            </div>

                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button" id="changePasswordBtn"
                                    class="px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all duration-300">
                                    <i class="fas fa-key mr-2"></i>Change Password
                                </button>
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="profileModal">
                                    Cancel
                                </button>
                                <button type="submit" id="updateProfileBtn"
                                    class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all duration-300">
                                    Update Profile
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Change Password Modal -->
                <div id="changePasswordModal" class="modal">
                    <div class="modal-content">
                        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-800">Change Password</h3>
                            <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors duration-300"
                                data-modal="changePasswordModal">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <form id="changePasswordForm" class="p-6">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Current Password
                                        *</label>
                                    <input type="password" id="currentPassword"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">New Password *</label>
                                    <input type="password" id="newPassword"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Confirm New Password
                                        *</label>
                                    <input type="password" id="confirmPassword"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                                        required>
                                </div>
                            </div>

                            <div class="mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                <div class="flex">
                                    <i class="fas fa-exclamation-triangle text-yellow-500 mt-1 mr-3"></i>
                                    <div>
                                        <h4 class="text-sm font-medium text-yellow-800">Password Requirements</h4>
                                        <ul class="mt-1 text-sm text-yellow-700 list-disc list-inside">
                                            <li>At least 8 characters long</li>
                                            <li>Contains uppercase and lowercase letters</li>
                                            <li>Includes numbers and special characters</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-6 flex justify-end space-x-3">
                                <button type="button"
                                    class="close-modal px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300"
                                    data-modal="changePasswordModal">
                                    Cancel
                                </button>
                                <button type="submit" id="updatePasswordBtn"
                                    class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all duration-300">
                                    Change Password
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Backup & Restore Tab -->
                <div id="backup" class="tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-3xl font-bold text-gray-800">Backup & Restore</h2>
                        <div class="flex space-x-3">
                            <!-- Hidden file input for backup upload -->
                            <input type="file" id="backupFileInput" accept=".db" class="hidden">
                            <button
                                class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg"
                                id="backupUploadBtn">
                                <i class="fas fa-upload mr-2"></i>Upload & Restore Backup
                            </button>
                            <button
                                class="bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg"
                                id="createBackupBtn">
                                <i class="fas fa-download mr-2"></i>Download Backup
                            </button>
                        </div>
                    </div>

                    <!-- Warning Alert -->
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <i class="fas fa-exclamation-triangle text-yellow-400 mt-0.5"></i>
                            </div>
                            <div class="ml-3">
                                <h3 class="text-sm font-medium text-yellow-800">Important Notes</h3>
                                <div class="mt-2 text-sm text-yellow-700">
                                    <ul class="list-disc list-inside space-y-1">
                                        <li>Download Backup: Creates and downloads a .db file to your computer</li>
                                        <li>Upload & Restore: Upload a .db file from your computer to restore data</li>
                                        <li>Restoring will replace ALL current data with backup data</li>
                                        <li>Always download a backup before restoring</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Backup Information</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Last Backup:</span>
                                    <span class="font-semibold" id="lastBackupInfo">Never</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Backup Size:</span>
                                    <span class="font-semibold" id="backupSizeInfo">0 MB</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Database File:</span>
                                    <span class="font-semibold">cybernytronix.db</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Backup Location:</span>
                                    <span class="font-semibold">/backups/</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Quick Restore</h3>
                            <div class="space-y-4">
                                <select
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    id="backupFilesSelect">
                                    <option value="">Select existing backup file...</option>
                                </select>
                                <button
                                    class="w-full bg-red-500 hover:bg-red-600 text-white py-3 px-4 rounded-lg transition-all duration-300"
                                    id="restoreBackupBtn">
                                    <i class="fas fa-undo mr-2"></i>Restore Selected Backup
                                </button>
                                <p class="text-xs text-gray-500 text-center">
                                    Select from previously created backups
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Backup History</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Filename</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Size</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Type</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Status</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Created</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="backupHistoryTableBody">
                                    <!-- Backup history will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- JavaScript Application -->
        <script>
            // Application state
            let currentUser = null;
            let leads = [];
            let clients = [];
            let users = [];
            let projects = [];
            let tasks = [];
            let tickets = [];
            let vulnerabilities = [];
            let incidents = [];
            let alerts = [];
            let chatMessages = [];
            let systemLogs = [];
            let backups = [];
            let notifications = [];

            // DOM Elements
            const loginPage = document.getElementById('loginPage');
            const mainApp = document.getElementById('mainApp');
            const loginForm = document.getElementById('loginForm');
            const loginBtn = document.getElementById('loginBtn');
            const userName = document.getElementById('userName');
            const userRole = document.getElementById('userRole');
            const welcomeMessage = document.getElementById('welcomeMessage');
            const toggleSidebar = document.getElementById('toggleSidebar');
            const sidebar = document.getElementById('sidebar');
            const contentArea = document.getElementById('contentArea');
            const tabLinks = document.querySelectorAll('.tab-link');
            const tabContents = document.querySelectorAll('.tab-content');
            const profileDropdownBtn = document.getElementById('profileDropdownBtn');
            const profileDropdown = document.getElementById('profileDropdown');
            const logoutLink = document.getElementById('logoutLink');
            const usersTab = document.getElementById('usersTab');
            const systemLogsTab = document.getElementById('systemLogsTab');
            const backupTab = document.getElementById('backupTab');

            // Notification elements
            const notificationBtn = document.getElementById('notificationBtn');
            const notificationDropdown = document.getElementById('notificationDropdown');
            const notificationCount = document.getElementById('notificationCount');
            const notificationList = document.getElementById('notificationList');
            const clearNotifications = document.getElementById('clearNotifications');

            // Dashboard elements
            const totalLeads = document.getElementById('totalLeads');
            const activeClients = document.getElementById('activeClients');
            const pendingTasks = document.getElementById('pendingTasks');
            const monthlyRevenue = document.getElementById('monthlyRevenue');
            const recentLeads = document.getElementById('recentLeads');

            // Leads management
            const addLeadBtn = document.getElementById('addLeadBtn');
            const addLeadModal = document.getElementById('addLeadModal');
            const addLeadForm = document.getElementById('addLeadForm');
            const submitLeadBtn = document.getElementById('submitLeadBtn');
            const leadsTableBody = document.getElementById('leadsTableBody');
            const leadsCount = document.getElementById('leadsCount');
            const searchLeads = document.getElementById('searchLeads');
            const statusFilter = document.getElementById('statusFilter');

            // Clients management
            const addClientBtn = document.getElementById('addClientBtn');
            const addClientModal = document.getElementById('addClientModal');
            const addClientForm = document.getElementById('addClientForm');
            const submitClientBtn = document.getElementById('submitClientBtn');
            const clientsTableBody = document.getElementById('clientsTableBody');

            // Projects management
            const addProjectBtn = document.getElementById('addProjectBtn');
            const addProjectModal = document.getElementById('addProjectModal');
            const addProjectForm = document.getElementById('addProjectForm');
            const submitProjectBtn = document.getElementById('submitProjectBtn');
            const projectsTableBody = document.getElementById('projectsTableBody');

            // Tasks management
            const addTaskBtn = document.getElementById('addTaskBtn');
            const addTaskModal = document.getElementById('addTaskModal');
            const addTaskForm = document.getElementById('addTaskForm');
            const submitTaskBtn = document.getElementById('submitTaskBtn');
            const tasksTableBody = document.getElementById('tasksTableBody');

            // Tickets management
            const addTicketBtn = document.getElementById('addTicketBtn');
            const addTicketModal = document.getElementById('addTicketModal');
            const addTicketForm = document.getElementById('addTicketForm');
            const submitTicketBtn = document.getElementById('submitTicketBtn');
            const ticketsTableBody = document.getElementById('ticketsTableBody');

            // Security management
            const addVulnerabilityBtn = document.getElementById('addVulnerabilityBtn');
            const addVulnerabilityModal = document.getElementById('addVulnerabilityModal');
            const addVulnerabilityForm = document.getElementById('addVulnerabilityForm');
            const submitVulnerabilityBtn = document.getElementById('submitVulnerabilityBtn');
            const addIncidentBtn = document.getElementById('addIncidentBtn');
            const addIncidentModal = document.getElementById('addIncidentModal');
            const addIncidentForm = document.getElementById('addIncidentForm');
            const submitIncidentBtn = document.getElementById('submitIncidentBtn');
            const vulnerabilitiesList = document.getElementById('vulnerabilitiesList');
            const incidentsList = document.getElementById('incidentsList');
            const alertsList = document.getElementById('alertsList');

            // Users management
            const usersTableBody = document.getElementById('usersTableBody');
            const addUserBtn = document.getElementById('addUserBtn');
            const addUserModal = document.getElementById('addUserModal');
            const addUserForm = document.getElementById('addUserForm');
            const submitUserBtn = document.getElementById('submitUserBtn');

            // Chat
            const onlineUsersList = document.getElementById('onlineUsersList');
            const chatMessagesContainer = document.getElementById('chatMessages');
            const messageInput = document.getElementById('messageInput');
            const sendMessageBtn = document.getElementById('sendMessageBtn');

            // System logs
            const refreshLogsBtn = document.getElementById('refreshLogsBtn');
            const systemLogsTableBody = document.getElementById('systemLogsTableBody');

            // Backup & Restore
            const createBackupBtn = document.getElementById('createBackupBtn');
            const restoreBackupBtn = document.getElementById('restoreBackupBtn');
            const backupFilesSelect = document.getElementById('backupFilesSelect');
            const backupHistoryTableBody = document.getElementById('backupHistoryTableBody');
            const lastBackupInfo = document.getElementById('lastBackupInfo');
            const backupSizeInfo = document.getElementById('backupSizeInfo');

            // Profile Management
            const profileImageInput = document.getElementById('profileImageInput');
            const changeProfileImageBtn = document.getElementById('changeProfileImageBtn');
            const profileImage = document.getElementById('profileImage');
            const userProfilePic = document.getElementById('userProfilePic');

            // API Base URL
            const API_BASE = window.location.origin + '/api';

            // Utility functions
            function showNotification(message, type = 'success') {
                const notification = document.createElement('div');
                notification.className = `fixed top-4 right-4 p-4 rounded-xl shadow-lg z-50 transition-all duration-300 transform translate-x-full ${type === 'success' ? 'bg-green-500' : 'bg-red-500'} text-white`;
                notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;

                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.classList.remove('translate-x-full');
                }, 10);

                setTimeout(() => {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }

            function formatCurrency(amount) {
                return new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: 'USD'
                }).format(amount);
            }

            function formatDate(dateString) {
                if (!dateString) return 'N/A';
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
            }

            function setLoading(element, isLoading) {
                if (isLoading) {
                    element.classList.add('loading');
                    if (element.tagName === 'BUTTON') {
                        const originalText = element.innerHTML;
                        element.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Loading...';
                        element.dataset.originalText = originalText;
                    }
                } else {
                    element.classList.remove('loading');
                    if (element.tagName === 'BUTTON' && element.dataset.originalText) {
                        element.innerHTML = element.dataset.originalText;
                    }
                }
            }

            // Modal handling
            function openModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.style.display = 'block';
                    document.body.style.overflow = 'hidden';
                    setTimeout(() => {
                        modal.classList.add('fade-in');
                    }, 10);

                    document.addEventListener('keydown', handleEscapeKey);
                }
            }

            function closeModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('fade-in');
                    setTimeout(() => {
                        modal.style.display = 'none';
                        document.body.style.overflow = '';
                    }, 300);

                    document.removeEventListener('keydown', handleEscapeKey);
                }
            }

            function handleEscapeKey(e) {
                if (e.key === 'Escape') {
                    const openModal = document.querySelector('.modal[style*="display: block"]');
                    if (openModal) {
                        closeModal(openModal.id);
                    }
                }
            }

            // Enhanced modal event listeners
            document.addEventListener('click', function (e) {
                if (e.target.classList.contains('close-modal') || e.target.closest('.close-modal')) {
                    const button = e.target.classList.contains('close-modal') ? e.target : e.target.closest('.close-modal');
                    const modalId = button.getAttribute('data-modal');
                    closeModal(modalId);
                }

                if (e.target.classList.contains('modal')) {
                    closeModal(e.target.id);
                }

                if (e.target.classList.contains('cancel-btn') || e.target.closest('.cancel-btn')) {
                    const button = e.target.classList.contains('cancel-btn') ? e.target : e.target.closest('.cancel-btn');
                    const modalId = button.getAttribute('data-modal');
                    if (modalId) {
                        closeModal(modalId);
                    }
                }
            });

            // Add cancel buttons to all modal forms
            document.addEventListener('DOMContentLoaded', function () {
                const cancelButtons = document.querySelectorAll('button[data-modal]');
                cancelButtons.forEach(button => {
                    if (button.textContent.includes('Cancel')) {
                        button.classList.add('cancel-btn');
                    }
                });
            });

            // API Functions - ENHANCED SESSION HANDLING
            async function apiCall(endpoint, options = {}) {
                try {
                    const response = await fetch(API_BASE + endpoint, {
                        headers: {
                            'Content-Type': 'application/json',
                            ...options.headers
                        },
                        credentials: 'include', // Important for session cookies
                        ...options
                    });

                    // Handle session expiration
                    if (response.status === 401 && !endpoint.includes('/login') && !endpoint.includes('/user')) {
                        // Session expired, redirect to login
                        if (currentUser) {
                            showNotification('Session expired. Please login again.', 'error');
                        }
                        logout();
                        return null;
                    }

                    const data = await response.json();

                    if (!response.ok) {
                        throw new Error(data.error || 'Request failed');
                    }

                    return data;
                } catch (error) {
                    console.error('API call failed:', error);
                    if (!endpoint.includes('/user') && !endpoint.includes('/logout')) {
                        showNotification(error.message || 'Network error occurred', 'error');
                    }
                    return null;
                }
            }

            // Authentication - ENHANCED SESSION MANAGEMENT
            async function login(email, password) {
                setLoading(loginBtn, true);

                try {
                    const response = await fetch('/api/login', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ email, password }),
                        credentials: 'include' // Important for session cookies
                    });

                    const result = await response.json();
                    setLoading(loginBtn, false);

                    if (result && result.success) {
                        currentUser = result.user;
                        userName.textContent = currentUser.name;
                        userRole.textContent = currentUser.role === 'admin' ? 'Administrator' : 'User';
                        welcomeMessage.textContent = `Welcome back, ${currentUser.name}!`;
                        loginPage.classList.add('hidden');
                        mainApp.classList.remove('hidden');

                        // Update profile picture
                        if (currentUser.profile_pic) {
                            userProfilePic.src = currentUser.profile_pic;
                            profileImage.src = currentUser.profile_pic;
                        }

                        // Hide admin-only tabs for regular users
                        if (currentUser.role !== 'admin') {
                            usersTab.style.display = 'none';
                            systemLogsTab.style.display = 'none';
                            backupTab.style.display = 'none';
                        }

                        initializeApp();
                        showNotification('Login successful!', 'success');
                    } else {
                        const errorMessage = result?.error || 'Invalid email or password. Please check your credentials.';
                        showNotification(errorMessage, 'error');
                    }
                } catch (error) {
                    setLoading(loginBtn, false);
                    showNotification('Network error. Please check your connection and try again.', 'error');
                }
            }

            async function logout() {
                try {
                    await apiCall('/logout', { method: 'POST' });
                } catch (error) {
                    // Ignore errors during logout
                } finally {
                    currentUser = null;
                    mainApp.classList.add('hidden');
                    loginPage.classList.remove('hidden');
                    showNotification('Logged out successfully', 'success');
                }
            }

            // Check session on page load
            async function checkSession() {
                try {
                    const response = await fetch('/api/user', {
                        credentials: 'include'
                    });

                    if (response.ok) {
                        const result = await response.json();
                        if (result && result.user) {
                            currentUser = result.user;
                            userName.textContent = currentUser.name;
                            userRole.textContent = currentUser.role === 'admin' ? 'Administrator' : 'User';
                            welcomeMessage.textContent = `Welcome back, ${currentUser.name}!`;
                            loginPage.classList.add('hidden');
                            mainApp.classList.remove('hidden');

                            // Update profile picture
                            if (currentUser.profile_pic) {
                                userProfilePic.src = currentUser.profile_pic;
                                profileImage.src = currentUser.profile_pic;
                            }

                            // Hide admin-only tabs for regular users
                            if (currentUser.role !== 'admin') {
                                usersTab.style.display = 'none';
                                systemLogsTab.style.display = 'none';
                                backupTab.style.display = 'none';
                            }

                            initializeApp();
                        }
                    }
                } catch (error) {
                    console.log('No active session found');
                }
            }

            // Profile picture handling - FIXED SESSION ISSUES
            function setupProfilePictureUpload() {
                changeProfileImageBtn.addEventListener('click', () => {
                    profileImageInput.click();
                });

                profileImageInput.addEventListener('change', async (e) => {
                    const file = e.target.files[0];
                    if (!file) return;

                    // Check if it's an image file
                    if (!file.type.startsWith('image/')) {
                        showNotification('Please select a valid image file', 'error');
                        return;
                    }

                    // Check file size (max 5MB)
                    if (file.size > 5 * 1024 * 1024) {
                        showNotification('Image size should be less than 5MB', 'error');
                        return;
                    }

                    const formData = new FormData();
                    formData.append('profile_pic', file);

                    try {
                        const response = await fetch('/api/profile/picture', {
                            method: 'POST',
                            body: formData,
                            credentials: 'include' // Important for session
                        });

                        const result = await response.json();

                        if (result && result.success) {
                            // Update profile pictures
                            userProfilePic.src = result.profile_pic;
                            profileImage.src = result.profile_pic;
                            // Update current user session data
                            if (currentUser) {
                                currentUser.profile_pic = result.profile_pic;
                            }
                            showNotification('Profile picture updated successfully!', 'success');
                        } else {
                            showNotification(result?.error || 'Failed to update profile picture', 'error');
                        }
                    } catch (error) {
                        showNotification('Failed to upload profile picture', 'error');
                    }
                });
            }

            // Data loading functions
            async function loadDashboardStats() {
                const stats = await apiCall('/dashboard/stats');
                if (stats) {
                    totalLeads.textContent = stats.totalLeads || 0;
                    activeClients.textContent = stats.activeClients || 0;
                    pendingTasks.textContent = stats.pendingTasks || 0;
                    monthlyRevenue.textContent = formatCurrency(stats.monthlyRevenue || 0);
                }
            }

            async function loadLeads() {
                leads = await apiCall('/leads') || [];
                leadsCount.textContent = leads.length;
                renderLeadsTable();
                renderRecentLeads();
            }

            async function loadClients() {
                clients = await apiCall('/clients') || [];
                renderClientsTable();
                populateClientDropdowns();
            }

            async function loadProjects() {
                projects = await apiCall('/projects') || [];
                renderProjectsTable();
                populateProjectDropdowns();
            }

            async function loadTasks() {
                tasks = await apiCall('/tasks') || [];
                renderTasksTable();
            }

            async function loadTickets() {
                tickets = await apiCall('/tickets') || [];
                renderTicketsTable();
            }

            async function loadUsers() {
                if (currentUser && currentUser.role !== 'admin') return;

                users = await apiCall('/users') || [];
                renderUsersTable();
                renderOnlineUsers();
                populateUserDropdowns();
            }

            async function loadVulnerabilities() {
                vulnerabilities = await apiCall('/vulnerabilities') || [];
                renderVulnerabilities();
            }

            async function loadIncidents() {
                incidents = await apiCall('/incidents') || [];
                renderIncidents();
            }

            async function loadAlerts() {
                alerts = await apiCall('/security-alerts') || [];
                renderAlerts();
            }

            async function loadChatMessages() {
                chatMessages = await apiCall('/chat/messages') || [];
                renderChatMessages();
            }

            async function loadSystemLogs() {
                if (currentUser && currentUser.role !== 'admin') return;

                systemLogs = await apiCall('/system/logs') || [];
                renderSystemLogs();
            }

            async function loadBackups() {
                if (currentUser && currentUser.role !== 'admin') return;

                const backupList = await apiCall('/backups/list') || [];
                const backupHistory = await apiCall('/backups') || [];

                backups = backupList;
                renderBackupFiles();
                renderBackupHistory(backupHistory);

                if (backupList.length > 0) {
                    const latestBackup = backupList[0];
                    lastBackupInfo.textContent = formatDate(latestBackup.created);
                    backupSizeInfo.textContent = (latestBackup.size / (1024 * 1024)).toFixed(2) + ' MB';
                }
            }

            // NEW: Populate dropdown functions
            async function populateProjectDropdowns() {
                const projectDropdowns = [
                    'taskProject', 'editTaskProject', 'vulnerabilityProject', 
                    'projectClient', 'editProjectClient'
                ];
                
                for (const dropdownId of projectDropdowns) {
                    const dropdown = document.getElementById(dropdownId);
                    if (dropdown) {
                        // Clear existing options except the first one
                        while (dropdown.options.length > 1) {
                            dropdown.remove(1);
                        }
                        
                        // Add projects to dropdown
                        projects.forEach(project => {
                            const option = document.createElement('option');
                            option.value = project.id;
                            option.textContent = project.name;
                            dropdown.appendChild(option);
                        });
                    }
                }
            }

            async function populateUserDropdowns() {
                const userDropdowns = [
                    'taskAssignedTo', 'editTaskAssignedTo', 'projectAssignedTo', 'editProjectAssignedTo',
                    'ticketAssignedTo', 'editTicketAssignedTo', 'vulnerabilityAssignedTo', 'incidentAssignedTo'
                ];
                
                for (const dropdownId of userDropdowns) {
                    const dropdown = document.getElementById(dropdownId);
                    if (dropdown) {
                        // Clear existing options except the first one
                        while (dropdown.options.length > 1) {
                            dropdown.remove(1);
                        }
                        
                        // Add users to dropdown
                        users.forEach(user => {
                            const option = document.createElement('option');
                            option.value = user.id;
                            option.textContent = user.name;
                            dropdown.appendChild(option);
                        });
                    }
                }
            }

            async function populateClientDropdowns() {
                const clientDropdowns = [
                    'ticketClient', 'editTicketClient', 'incidentClient'
                ];
                
                for (const dropdownId of clientDropdowns) {
                    const dropdown = document.getElementById(dropdownId);
                    if (dropdown) {
                        // Clear existing options except the first one
                        while (dropdown.options.length > 1) {
                            dropdown.remove(1);
                        }
                        
                        // Add clients to dropdown
                        clients.forEach(client => {
                            const option = document.createElement('option');
                            option.value = client.id;
                            option.textContent = client.name;
                            dropdown.appendChild(option);
                        });
                    }
                }
            }

            // NEW: Notification system
            function addNotification(title, message, type = 'info') {
                const notification = {
                    id: Date.now(),
                    title,
                    message,
                    type,
                    timestamp: new Date(),
                    read: false
                };
                
                notifications.unshift(notification);
                updateNotificationUI();
                
                // Show desktop notification if supported
                if ('Notification' in window && Notification.permission === 'granted') {
                    new Notification(title, { body: message });
                }
            }

            function updateNotificationUI() {
                const unreadCount = notifications.filter(n => !n.read).length;
                
                // Update notification count badge
                if (unreadCount > 0) {
                    notificationCount.textContent = unreadCount;
                    notificationCount.classList.remove('hidden');
                } else {
                    notificationCount.classList.add('hidden');
                }
                
                // Update notification dropdown
                notificationList.innerHTML = '';
                
                if (notifications.length === 0) {
                    notificationList.innerHTML = `
                        <div class="p-4 text-center text-gray-500">
                            <i class="fas fa-bell-slash text-2xl mb-2"></i>
                            <p>No notifications</p>
                        </div>
                    `;
                    return;
                }
                
                notifications.slice(0, 5).forEach(notification => {
                    const notificationItem = document.createElement('div');
                    notificationItem.className = `p-3 border-b border-gray-200 hover:bg-gray-50 cursor-pointer ${notification.read ? '' : 'bg-blue-50'}`;
                    notificationItem.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-900">${notification.title}</h4>
                                <p class="text-sm text-gray-600 mt-1">${notification.message}</p>
                                <p class="text-xs text-gray-500 mt-1">${formatDate(notification.timestamp)}</p>
                            </div>
                            <span class="ml-2 flex-shrink-0">
                                <i class="fas ${notification.type === 'info' ? 'fa-info-circle text-blue-500' : 
                                    notification.type === 'success' ? 'fa-check-circle text-green-500' : 
                                    notification.type === 'warning' ? 'fa-exclamation-triangle text-yellow-500' : 
                                    'fa-exclamation-circle text-red-500'}"></i>
                            </span>
                        </div>
                    `;
                    
                    notificationItem.addEventListener('click', () => {
                        markNotificationAsRead(notification.id);
                    });
                    
                    notificationList.appendChild(notificationItem);
                });
            }

            function markNotificationAsRead(id) {
                const notification = notifications.find(n => n.id === id);
                if (notification) {
                    notification.read = true;
                    updateNotificationUI();
                }
            }

            function clearAllNotifications() {
                notifications = [];
                updateNotificationUI();
            }

            // NEW: Send notification to assigned user
            async function sendTaskAssignmentNotification(taskTitle, assignedUserId) {
                // In a real application, this would send a notification to the assigned user
                // For now, we'll just add it to the current user's notifications
                const assignedUser = users.find(u => u.id === assignedUserId);
                if (assignedUser) {
                    addNotification(
                        'New Task Assigned',
                        `You have been assigned to task: "${taskTitle}"`,
                        'info'
                    );
                }
            }

            // Render functions
            function renderLeadsTable() {
                if (!leadsTableBody) return;

                leadsTableBody.innerHTML = '';

                const searchTerm = searchLeads.value.toLowerCase();
                const statusFilterValue = statusFilter.value;

                const filteredLeads = leads.filter(lead => {
                    const matchesSearch = !searchTerm ||
                        lead.name.toLowerCase().includes(searchTerm) ||
                        lead.company?.toLowerCase().includes(searchTerm) ||
                        lead.email.toLowerCase().includes(searchTerm);

                    const matchesStatus = !statusFilterValue || lead.status === statusFilterValue;

                    return matchesSearch && matchesStatus;
                });

                leadsCount.textContent = filteredLeads.length;

                if (filteredLeads.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                    <td colspan="7" class="px-6 py-4 text-center text-gray-500">
                        No leads found
                    </td>
                `;
                    leadsTableBody.appendChild(row);
                    return;
                }

                filteredLeads.forEach(lead => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 transition-colors duration-300';
                    row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10">
                                <img class="h-10 w-10 rounded-full" src="https://ui-avatars.com/api/?name=${encodeURIComponent(lead.name)}&background=1e40af&color=fff" alt="">
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${lead.name}</div>
                                <div class="text-sm text-gray-500">${lead.company || 'No company'}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${lead.email}</div>
                        <div class="text-sm text-gray-500">${lead.phone || 'No phone'}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 capitalize">
                            ${lead.source}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="status-badge status-${lead.status}">${lead.status}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${formatCurrency(lead.value || 0)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button class="text-blue-600 hover:text-blue-900 mr-3 edit-lead" data-id="${lead.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-red-600 hover:text-red-900 delete-item" data-id="${lead.id}" data-type="leads" data-name="lead">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                    leadsTableBody.appendChild(row);
                });

                document.querySelectorAll('.edit-lead').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const leadId = e.target.closest('button').dataset.id;
                        editLead(leadId);
                    });
                });
            }

            function renderClientsTable() {
                if (!clientsTableBody) return;

                clientsTableBody.innerHTML = '';

                if (clients.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                    <td colspan="6" class="px-6 py-4 text-center text-gray-500">
                        No clients found
                    </td>
                `;
                    clientsTableBody.appendChild(row);
                    return;
                }

                clients.forEach(client => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 transition-colors duration-300';
                    row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10">
                                <img class="h-10 w-10 rounded-full" src="https://ui-avatars.com/api/?name=${encodeURIComponent(client.name)}&background=10b981&color=fff" alt="">
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${client.name}</div>
                                <div class="text-sm text-gray-500">${client.company || 'No company'}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${client.email}</div>
                        <div class="text-sm text-gray-500">${client.phone || 'No phone'}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${client.services || 'No services specified'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${client.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${client.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${formatCurrency(client.contract_value || 0)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button class="text-blue-600 hover:text-blue-900 mr-3 edit-client" data-id="${client.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-red-600 hover:text-red-900 delete-item" data-id="${client.id}" data-type="clients" data-name="client">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                    clientsTableBody.appendChild(row);
                });

                document.querySelectorAll('.edit-client').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const clientId = e.target.closest('button').dataset.id;
                        editClient(clientId);
                    });
                });
            }

            function renderProjectsTable() {
                if (!projectsTableBody) return;

                projectsTableBody.innerHTML = '';

                if (projects.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                    <td colspan="6" class="px-6 py-4 text-center text-gray-500">
                        No projects found
                    </td>
                `;
                    projectsTableBody.appendChild(row);
                    return;
                }

                projects.forEach(project => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 transition-colors duration-300';
                    row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${project.name}</div>
                                <div class="text-sm text-gray-500">${project.description || 'No description'}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${project.client_name || 'No client'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${project.status === 'completed' ? 'bg-green-100 text-green-800' : project.status === 'in_progress' ? 'bg-blue-100 text-blue-800' : 'bg-yellow-100 text-yellow-800'}">
                            ${project.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-green-600 h-2 rounded-full" style="width: ${project.progress || 0}%"></div>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">${project.progress || 0}%</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${formatCurrency(project.budget || 0)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button class="text-blue-600 hover:text-blue-900 mr-3 edit-project" data-id="${project.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-red-600 hover:text-red-900 delete-item" data-id="${project.id}" data-type="projects" data-name="project">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                    projectsTableBody.appendChild(row);
                });

                document.querySelectorAll('.edit-project').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const projectId = e.target.closest('button').dataset.id;
                        editProject(projectId);
                    });
                });
            }

            function renderTasksTable() {
                if (!tasksTableBody) return;

                tasksTableBody.innerHTML = '';

                if (tasks.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                    <td colspan="6" class="px-6 py-4 text-center text-gray-500">
                        No tasks found
                    </td>
                `;
                    tasksTableBody.appendChild(row);
                    return;
                }

                tasks.forEach(task => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 transition-colors duration-300';
                    row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${task.title}</div>
                                <div class="text-sm text-gray-500">${task.description || 'No description'}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${task.project_name || 'No project'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${task.assigned_name || 'Unassigned'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${task.status === 'completed' ? 'bg-green-100 text-green-800' : task.status === 'in_progress' ? 'bg-blue-100 text-blue-800' : 'bg-yellow-100 text-yellow-800'}">
                            ${task.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${formatDate(task.due_date)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button class="text-blue-600 hover:text-blue-900 mr-3 edit-task" data-id="${task.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-red-600 hover:text-red-900 delete-item" data-id="${task.id}" data-type="tasks" data-name="task">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                    tasksTableBody.appendChild(row);
                });

                document.querySelectorAll('.edit-task').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const taskId = e.target.closest('button').dataset.id;
                        editTask(taskId);
                    });
                });
            }

            function renderTicketsTable() {
                if (!ticketsTableBody) return;

                ticketsTableBody.innerHTML = '';

                if (tickets.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                    <td colspan="6" class="px-6 py-4 text-center text-gray-500">
                        No tickets found
                    </td>
                `;
                    ticketsTableBody.appendChild(row);
                    return;
                }

                tickets.forEach(ticket => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 transition-colors duration-300';
                    row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${ticket.title}</div>
                                <div class="text-sm text-gray-500">${ticket.description || 'No description'}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${ticket.client_name || 'No client'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800 capitalize">
                            ${ticket.type}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="priority-${ticket.priority} status-badge">${ticket.priority}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ticket.status === 'resolved' ? 'bg-green-100 text-green-800' : ticket.status === 'in_progress' ? 'bg-blue-100 text-blue-800' : 'bg-yellow-100 text-yellow-800'}">
                            ${ticket.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button class="text-blue-600 hover:text-blue-900 mr-3 edit-ticket" data-id="${ticket.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-red-600 hover:text-red-900 delete-item" data-id="${ticket.id}" data-type="tickets" data-name="ticket">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                    ticketsTableBody.appendChild(row);
                });

                document.querySelectorAll('.edit-ticket').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const ticketId = e.target.closest('button').dataset.id;
                        editTicket(ticketId);
                    });
                });
            }

            function renderUsersTable() {
                if (!usersTableBody || !currentUser || currentUser.role !== 'admin') return;

                usersTableBody.innerHTML = '';

                if (users.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                    <td colspan="6" class="px-6 py-4 text-center text-gray-500">
                        No users found
                    </td>
                `;
                    usersTableBody.appendChild(row);
                    return;
                }

                users.forEach(user => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 transition-colors duration-300';
                    row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10">
                                <img class="h-10 w-10 rounded-full" src="${user.profile_pic || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.name)}&background=f59e0b&color=fff`}" alt="">
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${user.name}</div>
                                <div class="text-sm text-gray-500">${user.email}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${user.role === 'admin' ? 'bg-purple-100 text-purple-800' : 'bg-blue-100 text-blue-800'}">
                            ${user.role}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${user.department || 'Not specified'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${user.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${user.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${user.last_login ? new Date(user.last_login).toLocaleDateString() : 'Never'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button class="text-blue-600 hover:text-blue-900 mr-3 edit-user" data-id="${user.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-green-600 hover:text-green-900 mr-3 reset-password" data-id="${user.id}" data-name="${user.name}">
                            <i class="fas fa-key"></i>
                        </button>
                        <button class="text-red-600 hover:text-red-900 delete-item" data-id="${user.id}" data-type="users" data-name="user">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                    usersTableBody.appendChild(row);
                });

                document.querySelectorAll('.edit-user').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const userId = e.target.closest('button').dataset.id;
                        editUser(userId);
                    });
                });

                document.querySelectorAll('.reset-password').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const userId = e.target.closest('button').dataset.id;
                        const userName = e.target.closest('button').dataset.name;
                        resetUserPassword(userId, userName);
                    });
                });
            }

            function renderRecentLeads() {
                if (!recentLeads) return;

                recentLeads.innerHTML = '';
                const recent = leads.slice(0, 5);

                if (recent.length === 0) {
                    recentLeads.innerHTML = `
                    <div class="text-center py-4 text-gray-500">
                        No recent leads
                    </div>
                `;
                    return;
                }

                recent.forEach(lead => {
                    const leadElement = document.createElement('div');
                    leadElement.className = 'flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg transition-colors duration-300';
                    leadElement.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <img class="h-8 w-8 rounded-full" src="https://ui-avatars.com/api/?name=${encodeURIComponent(lead.name)}&background=1e40af&color=fff" alt="">
                        <div>
                            <div class="text-sm font-medium text-gray-900">${lead.name}</div>
                            <div class="text-sm text-gray-500">${lead.email}</div>
                        </div>
                    </div>
                    <span class="status-badge status-${lead.status}">${lead.status}</span>
                `;
                    recentLeads.appendChild(leadElement);
                });
            }

            function renderOnlineUsers() {
                if (!onlineUsersList) return;

                onlineUsersList.innerHTML = '';
                users.forEach(user => {
                    const listItem = document.createElement('li');
                    listItem.className = 'flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 transition-colors duration-300';
                    listItem.innerHTML = `
                    <div class="relative">
                        <img class="h-8 w-8 rounded-full" src="${user.profile_pic || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.name)}&background=10b981&color=fff`}" alt="">
                        <span class="absolute bottom-0 right-0 block h-2 w-2 rounded-full bg-green-400 ring-2 ring-white"></span>
                    </div>
                    <div>
                        <p class="text-sm font-medium text-gray-900">${user.name}</p>
                        <p class="text-xs text-gray-500">${user.position || user.role}</p>
                    </div>
                `;
                    onlineUsersList.appendChild(listItem);
                });
            }

            function renderVulnerabilities() {
                if (!vulnerabilitiesList) return;

                vulnerabilitiesList.innerHTML = '';

                if (vulnerabilities.length === 0) {
                    vulnerabilitiesList.innerHTML = `
                    <div class="text-center text-gray-500 py-4">
                        No vulnerabilities found
                    </div>
                `;
                    return;
                }

                vulnerabilities.slice(0, 5).forEach(vuln => {
                    const vulnElement = document.createElement('div');
                    vulnElement.className = 'p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-300';
                    vulnElement.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-gray-900">${vuln.title}</h4>
                        <span class="priority-${vuln.severity} status-badge">${vuln.severity}</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">${vuln.description || 'No description'}</p>
                    <div class="flex justify-between text-xs text-gray-500">
                        <span>CVSS: ${vuln.cvss_score || 'N/A'}</span>
                        <span>${formatDate(vuln.created_at)}</span>
                    </div>
                `;
                    vulnerabilitiesList.appendChild(vulnElement);
                });
            }

            function renderIncidents() {
                if (!incidentsList) return;

                incidentsList.innerHTML = '';

                if (incidents.length === 0) {
                    incidentsList.innerHTML = `
                    <div class="text-center text-gray-500 py-4">
                        No incidents found
                    </div>
                `;
                    return;
                }

                incidents.slice(0, 5).forEach(incident => {
                    const incidentElement = document.createElement('div');
                    incidentElement.className = 'p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-300';
                    incidentElement.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-gray-900">${incident.title}</h4>
                        <span class="priority-${incident.severity} status-badge">${incident.severity}</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">${incident.description || 'No description'}</p>
                    <div class="flex justify-between text-xs text-gray-500">
                        <span>${incident.client_name || 'No client'}</span>
                        <span>${formatDate(incident.created_at)}</span>
                    </div>
                `;
                    incidentsList.appendChild(incidentElement);
                });
            }

            function renderAlerts() {
                if (!alertsList) return;

                alertsList.innerHTML = '';

                if (alerts.length === 0) {
                    alertsList.innerHTML = `
                    <div class="text-center text-gray-500 py-4">
                        No security alerts
                    </div>
                `;
                    return;
                }

                alerts.slice(0, 5).forEach(alert => {
                    const alertElement = document.createElement('div');
                    alertElement.className = 'p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-300';
                    alertElement.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-gray-900">${alert.title}</h4>
                        <span class="priority-${alert.severity} status-badge">${alert.severity}</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">${alert.description || 'No description'}</p>
                    <div class="flex justify-between text-xs text-gray-500">
                        <span>Source: ${alert.source || 'Unknown'}</span>
                        <span>${formatDate(alert.created_at)}</span>
                    </div>
                `;
                    alertsList.appendChild(alertElement);
                });
            }

            function renderChatMessages() {
                if (!chatMessagesContainer) return;

                chatMessagesContainer.innerHTML = '';

                if (chatMessages.length === 0) {
                    chatMessagesContainer.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <i class="fas fa-comments text-2xl mb-2"></i>
                        <p>No messages yet. Start the conversation!</p>
                    </div>
                `;
                    return;
                }

                chatMessages.forEach(msg => {
                    const messageDiv = document.createElement('div');
                    const isCurrentUser = currentUser && msg.user_name === currentUser.name;
                    messageDiv.className = `chat-message ${isCurrentUser ? 'ml-auto' : 'mr-auto'}`;
                    messageDiv.innerHTML = `
                    <div class="flex ${isCurrentUser ? 'flex-row-reverse' : ''} space-x-3">
                        <img class="h-8 w-8 rounded-full" src="${msg.profile_pic || `https://ui-avatars.com/api/?name=${encodeURIComponent(msg.user_name)}&background=1e40af&color=fff`}" alt="">
                        <div class="flex-1 ${isCurrentUser ? 'text-right' : ''}">
                            <div class="flex items-center ${isCurrentUser ? 'justify-end' : ''} space-x-2 mb-1">
                                <span class="text-sm font-medium text-gray-900">${msg.user_name}</span>
                                <span class="text-xs text-gray-500">${new Date(msg.created_at).toLocaleTimeString()}</span>
                            </div>
                            <div class="bg-white border border-gray-200 rounded-lg p-3 shadow-sm">
                                <p class="text-gray-800">${msg.message}</p>
                            </div>
                        </div>
                    </div>
                `;
                    chatMessagesContainer.appendChild(messageDiv);
                });
                chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
            }

            function renderSystemLogs() {
                if (!systemLogsTableBody) return;

                systemLogsTableBody.innerHTML = '';

                if (systemLogs.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                    <td colspan="5" class="px-6 py-4 text-center text-gray-500">
                        No system logs found
                    </td>
                `;
                    systemLogsTableBody.appendChild(row);
                    return;
                }

                systemLogs.forEach(log => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 transition-colors duration-300';
                    row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${log.user_name || 'System'}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                            ${log.action}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-900">
                        ${log.description || 'No description'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${log.ip_address || 'N/A'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${formatDate(log.created_at)}
                    </td>
                `;
                    systemLogsTableBody.appendChild(row);
                });
            }

            function renderBackupFiles() {
                if (!backupFilesSelect) return;

                backupFilesSelect.innerHTML = '<option value="">Select backup file...</option>';

                backups.forEach(backup => {
                    const option = document.createElement('option');
                    option.value = backup.filename;
                    option.textContent = `${backup.filename} (${(backup.size / (1024 * 1024)).toFixed(2)} MB)`;
                    backupFilesSelect.appendChild(option);
                });
            }

            function renderBackupHistory(backupHistory) {
                if (!backupHistoryTableBody) return;

                backupHistoryTableBody.innerHTML = '';

                if (backupHistory.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                    <td colspan="6" class="px-6 py-4 text-center text-gray-500">
                        No backup history found
                    </td>
                `;
                    backupHistoryTableBody.appendChild(row);
                    return;
                }

                backupHistory.forEach(backup => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 transition-colors duration-300';
                    row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                        ${backup.filename}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${backup.size_bytes ? (backup.size_bytes / (1024 * 1024)).toFixed(2) + ' MB' : 'N/A'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                            ${backup.backup_type || 'manual'}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${backup.status === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${backup.status || 'success'}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${formatDate(backup.created_at)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2">
                        <button class="text-blue-600 hover:text-blue-900 download-backup" data-filename="${backup.filename}" title="Download Backup">
                            <i class="fas fa-download"></i>
                        </button>
                        <button class="text-green-600 hover:text-green-900 restore-backup" data-filename="${backup.filename}" title="Restore Backup">
                            <i class="fas fa-undo"></i>
                        </button>
                    </td>
                `;
                    backupHistoryTableBody.appendChild(row);
                });

                document.querySelectorAll('.download-backup').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const filename = e.target.closest('button').dataset.filename;
                        downloadBackup(filename);
                    });
                });

                document.querySelectorAll('.restore-backup').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const filename = e.target.closest('button').dataset.filename;
                        if (confirm('Restore from this backup? This will replace all current data.')) {
                            restoreBackupFromHistory(filename);
                        }
                    });
                });
            }

            // Edit functionality for all modules
            async function editLead(leadId) {
                const lead = await apiCall(`/leads/${leadId}`);
                if (lead) {
                    document.getElementById('editLeadId').value = lead.id;
                    document.getElementById('editLeadName').value = lead.name;
                    document.getElementById('editLeadCompany').value = lead.company || '';
                    document.getElementById('editLeadEmail').value = lead.email;
                    document.getElementById('editLeadPhone').value = lead.phone || '';
                    document.getElementById('editLeadSource').value = lead.source || 'website';
                    document.getElementById('editLeadStatus').value = lead.status || 'new';
                    document.getElementById('editLeadPriority').value = lead.priority || 'medium';
                    document.getElementById('editLeadValue').value = lead.value || 0;
                    document.getElementById('editLeadNotes').value = lead.notes || '';

                    openModal('editLeadModal');
                }
            }

            async function editClient(clientId) {
                const client = await apiCall(`/clients/${clientId}`);
                if (client) {
                    document.getElementById('editClientId').value = client.id;
                    document.getElementById('editClientName').value = client.name;
                    document.getElementById('editClientCompany').value = client.company || '';
                    document.getElementById('editClientEmail').value = client.email;
                    document.getElementById('editClientPhone').value = client.phone || '';
                    document.getElementById('editClientAddress').value = client.address || '';
                    document.getElementById('editClientWebsite').value = client.website || '';
                    document.getElementById('editClientIndustry').value = client.industry || '';
                    document.getElementById('editClientServices').value = client.services || '';
                    document.getElementById('editClientContractValue').value = client.contract_value || 0;
                    document.getElementById('editClientStatus').value = client.status || 'active';
                    document.getElementById('editClientNotes').value = client.notes || '';

                    openModal('editClientModal');
                }
            }

            async function editProject(projectId) {
                const project = await apiCall(`/projects/${projectId}`);
                if (project) {
                    document.getElementById('editProjectId').value = project.id;
                    document.getElementById('editProjectName').value = project.name;
                    document.getElementById('editProjectDescription').value = project.description || '';
                    document.getElementById('editProjectClient').value = project.client_id || '';
                    document.getElementById('editProjectStatus').value = project.status || 'planning';
                    document.getElementById('editProjectPriority').value = project.priority || 'medium';
                    document.getElementById('editProjectAssignedTo').value = project.assigned_to || '';
                    document.getElementById('editProjectStartDate').value = project.start_date || '';
                    document.getElementById('editProjectEndDate').value = project.end_date || '';
                    document.getElementById('editProjectBudget').value = project.budget || 0;
                    document.getElementById('editProjectProgress').value = project.progress || 0;

                    openModal('editProjectModal');
                }
            }

            async function editTask(taskId) {
                const task = await apiCall(`/tasks/${taskId}`);
                if (task) {
                    document.getElementById('editTaskId').value = task.id;
                    document.getElementById('editTaskTitle').value = task.title;
                    document.getElementById('editTaskDescription').value = task.description || '';
                    document.getElementById('editTaskProject').value = task.project_id || '';
                    document.getElementById('editTaskAssignedTo').value = task.assigned_to || '';
                    document.getElementById('editTaskStatus').value = task.status || 'pending';
                    document.getElementById('editTaskPriority').value = task.priority || 'medium';
                    document.getElementById('editTaskDueDate').value = task.due_date || '';
                    document.getElementById('editTaskEstimatedHours').value = task.time_spent || 0;

                    openModal('editTaskModal');
                }
            }

            async function editTicket(ticketId) {
                const ticket = await apiCall(`/tickets/${ticketId}`);
                if (ticket) {
                    document.getElementById('editTicketId').value = ticket.id;
                    document.getElementById('editTicketTitle').value = ticket.title;
                    document.getElementById('editTicketDescription').value = ticket.description || '';
                    document.getElementById('editTicketClient').value = ticket.client_id || '';
                    document.getElementById('editTicketType').value = ticket.type || 'technical_support';
                    document.getElementById('editTicketPriority').value = ticket.priority || 'medium';
                    document.getElementById('editTicketStatus').value = ticket.status || 'open';
                    document.getElementById('editTicketAssignedTo').value = ticket.assigned_to || '';

                    openModal('editTicketModal');
                }
            }

            async function editUser(userId) {
                const user = await apiCall(`/users/${userId}`);
                if (user) {
                    document.getElementById('editUserId').value = user.id;
                    document.getElementById('editUserName').value = user.name;
                    document.getElementById('editUserEmail').value = user.email;
                    document.getElementById('editUserRole').value = user.role || 'user';
                    document.getElementById('editUserDepartment').value = user.department || '';
                    document.getElementById('editUserPosition').value = user.position || '';
                    document.getElementById('editUserPhone').value = user.phone || '';
                    document.getElementById('editUserStatus').value = user.status || 'active';

                    openModal('editUserModal');
                }
            }

            // Reset user password functionality
            function resetUserPassword(userId, userName) {
                document.getElementById('resetPasswordUserId').value = userId;
                document.getElementById('resetPasswordUserName').textContent = userName;
                openModal('resetPasswordModal');
            }

            async function resetPassword(passwordData) {
                setLoading(document.getElementById('updatePasswordBtn'), true);

                const result = await apiCall(`/users/${passwordData.userId}/reset-password`, {
                    method: 'PUT',
                    body: JSON.stringify({
                        newPassword: passwordData.newPassword
                    })
                });

                setLoading(document.getElementById('updatePasswordBtn'), false);

                if (result && result.success) {
                    showNotification('Password reset successfully!', 'success');
                    closeModal('resetPasswordModal');
                    document.getElementById('resetPasswordForm').reset();
                } else {
                    showNotification(result?.error || 'Failed to reset password', 'error');
                }
            }

            // Delete functionality for all modules
            async function deleteItem(itemId, itemType, itemName) {
                if (confirm(`Are you sure you want to delete this ${itemName}? This action cannot be undone.`)) {
                    const result = await apiCall(`/${itemType}/${itemId}`, {
                        method: 'DELETE'
                    });

                    if (result && result.success) {
                        showNotification(`${itemName} deleted successfully!`, 'success');
                        const currentTab = document.querySelector('.tab-content.active').id;
                        if (currentTab === 'leads') await loadLeads();
                        else if (currentTab === 'clients') await loadClients();
                        else if (currentTab === 'projects') await loadProjects();
                        else if (currentTab === 'tasks') await loadTasks();
                        else if (currentTab === 'tickets') await loadTickets();
                        else if (currentTab === 'users') await loadUsers();
                        await loadDashboardStats();
                    } else {
                        showNotification(`Failed to delete ${itemName}`, 'error');
                    }
                }
            }

            // Profile management
            async function loadProfile() {
                const profile = await apiCall('/profile');
                if (profile) {
                    document.getElementById('profileFullName').value = profile.name;
                    document.getElementById('profileEmailInput').value = profile.email;
                    document.getElementById('profilePhone').value = profile.phone || '';
                    document.getElementById('profileDepartment').value = profile.department || '';
                    document.getElementById('profilePosition').value = profile.position || '';
                    document.getElementById('profileLastLogin').value = profile.last_login ? new Date(profile.last_login).toLocaleString() : 'Never';

                    document.getElementById('profileName').textContent = profile.name;
                    document.getElementById('profileRole').textContent = profile.role === 'admin' ? 'Administrator' : 'User';
                    document.getElementById('profileEmail').textContent = profile.email;

                    // Update profile picture if available
                    if (profile.profile_pic) {
                        profileImage.src = profile.profile_pic;
                        userProfilePic.src = profile.profile_pic;
                    }
                }
            }

            async function updateProfile(profileData) {
                setLoading(document.getElementById('updateProfileBtn'), true);

                const result = await apiCall('/profile', {
                    method: 'PUT',
                    body: JSON.stringify(profileData)
                });

                setLoading(document.getElementById('updateProfileBtn'), false);

                if (result && result.success) {
                    showNotification('Profile updated successfully!', 'success');
                    closeModal('profileModal');
                    await loadProfile();
                    if (currentUser) {
                        currentUser.name = profileData.name;
                        currentUser.email = profileData.email;
                        userName.textContent = currentUser.name;
                        welcomeMessage.textContent = `Welcome back, ${currentUser.name}!`;
                    }
                } else {
                    showNotification(result?.error || 'Failed to update profile', 'error');
                }
            }

            async function changePassword(passwordData) {
                setLoading(document.getElementById('updatePasswordBtn'), true);

                const result = await apiCall('/change-password', {
                    method: 'PUT',
                    body: JSON.stringify({
                        currentPassword: passwordData.current_password,
                        newPassword: passwordData.new_password
                    })
                });

                setLoading(document.getElementById('updatePasswordBtn'), false);

                if (result && result.success) {
                    showNotification('Password changed successfully!', 'success');
                    closeModal('changePasswordModal');
                    document.getElementById('changePasswordForm').reset();
                } else {
                    showNotification(result?.error || 'Failed to change password', 'error');
                }
            }

            // Lead management functions
            async function addLead(leadData) {
                setLoading(submitLeadBtn, true);

                const result = await apiCall('/leads', {
                    method: 'POST',
                    body: JSON.stringify(leadData)
                });

                setLoading(submitLeadBtn, false);

                if (result && result.success) {
                    showNotification('Lead added successfully!', 'success');
                    closeModal('addLeadModal');
                    addLeadForm.reset();
                    await loadLeads();
                    await loadDashboardStats();
                } else {
                    showNotification(result?.error || 'Failed to add lead', 'error');
                }
            }

            async function updateLead(leadData) {
                setLoading(document.getElementById('updateLeadBtn'), true);

                const result = await apiCall(`/leads/${leadData.id}`, {
                    method: 'PUT',
                    body: JSON.stringify(leadData)
                });

                setLoading(document.getElementById('updateLeadBtn'), false);

                if (result && result.success) {
                    showNotification('Lead updated successfully!', 'success');
                    closeModal('editLeadModal');
                    await loadLeads();
                    await loadDashboardStats();
                } else {
                    showNotification(result?.error || 'Failed to update lead', 'error');
                }
            }

            async function updateClient(clientData) {
                setLoading(document.getElementById('updateClientBtn'), true);

                const result = await apiCall(`/clients/${clientData.id}`, {
                    method: 'PUT',
                    body: JSON.stringify(clientData)
                });

                setLoading(document.getElementById('updateClientBtn'), false);

                if (result && result.success) {
                    showNotification('Client updated successfully!', 'success');
                    closeModal('editClientModal');
                    await loadClients();
                    await loadDashboardStats();
                } else {
                    showNotification(result?.error || 'Failed to update client', 'error');
                }
            }

            async function updateProject(projectData) {
                setLoading(document.getElementById('updateProjectBtn'), true);

                const result = await apiCall(`/projects/${projectData.id}`, {
                    method: 'PUT',
                    body: JSON.stringify(projectData)
                });

                setLoading(document.getElementById('updateProjectBtn'), false);

                if (result && result.success) {
                    showNotification('Project updated successfully!', 'success');
                    closeModal('editProjectModal');
                    await loadProjects();
                    await loadDashboardStats();
                } else {
                    showNotification(result?.error || 'Failed to update project', 'error');
                }
            }

            async function updateTask(taskData) {
                setLoading(document.getElementById('updateTaskBtn'), true);

                const result = await apiCall(`/tasks/${taskData.id}`, {
                    method: 'PUT',
                    body: JSON.stringify(taskData)
                });

                setLoading(document.getElementById('updateTaskBtn'), false);

                if (result && result.success) {
                    showNotification('Task updated successfully!', 'success');
                    closeModal('editTaskModal');
                    await loadTasks();
                    await loadDashboardStats();
                    
                    // Send notification to assigned user
                    if (taskData.assigned_to) {
                        sendTaskAssignmentNotification(taskData.title, taskData.assigned_to);
                    }
                } else {
                    showNotification(result?.error || 'Failed to update task', 'error');
                }
            }

            async function updateTicket(ticketData) {
                setLoading(document.getElementById('updateTicketBtn'), true);

                const result = await apiCall(`/tickets/${ticketData.id}`, {
                    method: 'PUT',
                    body: JSON.stringify(ticketData)
                });

                setLoading(document.getElementById('updateTicketBtn'), false);

                if (result && result.success) {
                    showNotification('Ticket updated successfully!', 'success');
                    closeModal('editTicketModal');
                    await loadTickets();
                    await loadDashboardStats();
                } else {
                    showNotification(result?.error || 'Failed to update ticket', 'error');
                }
            }

            async function updateUser(userData) {
                setLoading(document.getElementById('updateUserBtn'), true);

                const result = await apiCall(`/users/${userData.id}`, {
                    method: 'PUT',
                    body: JSON.stringify(userData)
                });

                setLoading(document.getElementById('updateUserBtn'), false);

                if (result && result.success) {
                    showNotification('User updated successfully!', 'success');
                    closeModal('editUserModal');
                    await loadUsers();
                } else {
                    showNotification(result?.error || 'Failed to update user', 'error');
                }
            }

            // Client management functions
            async function addClient(clientData) {
                setLoading(submitClientBtn, true);

                const result = await apiCall('/clients', {
                    method: 'POST',
                    body: JSON.stringify(clientData)
                });

                setLoading(submitClientBtn, false);

                if (result && result.success) {
                    showNotification('Client added successfully!', 'success');
                    closeModal('addClientModal');
                    addClientForm.reset();
                    await loadClients();
                    await loadDashboardStats();
                } else {
                    showNotification(result?.error || 'Failed to add client', 'error');
                }
            }

            // Project management functions
            async function addProject(projectData) {
                setLoading(submitProjectBtn, true);

                const result = await apiCall('/projects', {
                    method: 'POST',
                    body: JSON.stringify(projectData)
                });

                setLoading(submitProjectBtn, false);

                if (result && result.success) {
                    showNotification('Project added successfully!', 'success');
                    closeModal('addProjectModal');
                    addProjectForm.reset();
                    await loadProjects();
                    await loadDashboardStats();
                } else {
                    showNotification(result?.error || 'Failed to add project', 'error');
                }
            }

            // Task management functions
            async function addTask(taskData) {
                setLoading(submitTaskBtn, true);

                const result = await apiCall('/tasks', {
                    method: 'POST',
                    body: JSON.stringify(taskData)
                });

                setLoading(submitTaskBtn, false);

                if (result && result.success) {
                    showNotification('Task added successfully!', 'success');
                    closeModal('addTaskModal');
                    addTaskForm.reset();
                    await loadTasks();
                    await loadDashboardStats();
                    
                    // Send notification to assigned user
                    if (taskData.assigned_to) {
                        sendTaskAssignmentNotification(taskData.title, taskData.assigned_to);
                    }
                } else {
                    showNotification(result?.error || 'Failed to add task', 'error');
                }
            }

            // Ticket management functions
            async function addTicket(ticketData) {
                setLoading(submitTicketBtn, true);

                const result = await apiCall('/tickets', {
                    method: 'POST',
                    body: JSON.stringify(ticketData)
                });

                setLoading(submitTicketBtn, false);

                if (result && result.success) {
                    showNotification('Ticket created successfully!', 'success');
                    closeModal('addTicketModal');
                    addTicketForm.reset();
                    await loadTickets();
                    await loadDashboardStats();
                } else {
                    showNotification(result?.error || 'Failed to create ticket', 'error');
                }
            }

            // User management functions
            async function addUser(userData) {
                setLoading(submitUserBtn, true);

                const result = await apiCall('/users', {
                    method: 'POST',
                    body: JSON.stringify(userData)
                });

                setLoading(submitUserBtn, false);

                if (result && result.success) {
                    showNotification('User added successfully!', 'success');
                    closeModal('addUserModal');
                    addUserForm.reset();
                    await loadUsers();
                } else {
                    showNotification(result?.error || 'Failed to add user', 'error');
                }
            }

            // Vulnerability management functions
            async function addVulnerability(vulnerabilityData) {
                setLoading(submitVulnerabilityBtn, true);

                const result = await apiCall('/vulnerabilities', {
                    method: 'POST',
                    body: JSON.stringify(vulnerabilityData)
                });

                setLoading(submitVulnerabilityBtn, false);

                if (result && result.success) {
                    showNotification('Vulnerability added successfully!', 'success');
                    closeModal('addVulnerabilityModal');
                    addVulnerabilityForm.reset();
                    await loadVulnerabilities();
                } else {
                    showNotification(result?.error || 'Failed to add vulnerability', 'error');
                }
            }

            // Incident management functions
            async function addIncident(incidentData) {
                setLoading(submitIncidentBtn, true);

                const result = await apiCall('/incidents', {
                    method: 'POST',
                    body: JSON.stringify(incidentData)
                });

                setLoading(submitIncidentBtn, false);

                if (result && result.success) {
                    showNotification('Incident reported successfully!', 'success');
                    closeModal('addIncidentModal');
                    addIncidentForm.reset();
                    await loadIncidents();
                } else {
                    showNotification(result?.error || 'Failed to report incident', 'error');
                }
            }

            // Chat functions
            async function sendMessage(message) {
                const result = await apiCall('/chat/messages', {
                    method: 'POST',
                    body: JSON.stringify({ message })
                });

                if (result && result.success) {
                    await loadChatMessages();
                    document.getElementById('messageInput').value = '';
                } else {
                    showNotification('Failed to send message', 'error');
                }
            }

            // Enhanced Backup Functions
            async function createBackup() {
                setLoading(createBackupBtn, true);

                try {
                    const result = await apiCall('/backups/create', {
                        method: 'POST'
                    });

                    if (result && result.success) {
                        showNotification('Backup created successfully! Download will start automatically.', 'success');

                        if (result.download_url) {
                            const downloadUrl = `${window.location.origin}${result.download_url}`;
                            const a = document.createElement('a');
                            a.href = downloadUrl;
                            a.download = result.filename || 'backup.db';
                            document.body.appendChild(a);
                            a.click();
                            document.body.removeChild(a);
                        }

                        await loadBackups();
                    } else {
                        showNotification(result?.error || 'Failed to create backup', 'error');
                    }
                } catch (error) {
                    showNotification('Backup creation failed: ' + error.message, 'error');
                } finally {
                    setLoading(createBackupBtn, false);
                }
            }

            async function restoreBackup() {
                const backupFile = backupFilesSelect.value;

                if (!backupFile) {
                    showNotification('Please select a backup file to restore', 'error');
                    return;
                }

                if (confirm(' WARNING: This will replace ALL current data with the backup data. This action cannot be undone. Are you sure you want to continue?')) {
                    setLoading(restoreBackupBtn, true);

                    try {
                        const result = await apiCall('/backups/restore', {
                            method: 'POST',
                            body: JSON.stringify({ backupFile })
                        });

                        if (result && result.success) {
                            showNotification('Backup restored successfully! The system will reload in 3 seconds.', 'success');
                            setTimeout(() => {
                                location.reload();
                            }, 3000);
                        } else {
                            showNotification(result?.error || 'Failed to restore backup', 'error');
                        }
                    } catch (error) {
                        showNotification('Restore failed: ' + error.message, 'error');
                    } finally {
                        setLoading(restoreBackupBtn, false);
                    }
                }
            }

            async function downloadBackup(filename) {
                try {
                    const downloadUrl = `${window.location.origin}/api/backups/download/${filename}`;
                    const a = document.createElement('a');
                    a.href = downloadUrl;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    showNotification('Download started: ' + filename, 'success');
                } catch (error) {
                    showNotification('Download failed: ' + error.message, 'error');
                }
            }

            async function restoreBackupFromHistory(filename) {
                setLoading(restoreBackupBtn, true);

                try {
                    const result = await apiCall('/backups/restore', {
                        method: 'POST',
                        body: JSON.stringify({ backupFile: filename })
                    });

                    if (result && result.success) {
                        showNotification('Backup restored successfully! Reloading...', 'success');
                        setTimeout(() => {
                            location.reload();
                        }, 2000);
                    } else {
                        showNotification(result?.error || 'Failed to restore backup', 'error');
                    }
                } catch (error) {
                    showNotification('Restore failed: ' + error.message, 'error');
                } finally {
                    setLoading(restoreBackupBtn, false);
                }
            }

            // Backup upload functionality setup
            function setupBackupUpload() {
                const backupUploadBtn = document.getElementById('backupUploadBtn');
                const backupFileInput = document.getElementById('backupFileInput');

                if (backupUploadBtn && backupFileInput) {
                    backupUploadBtn.addEventListener('click', () => {
                        backupFileInput.click();
                    });

                    backupFileInput.addEventListener('change', async (e) => {
                        const file = e.target.files[0];
                        if (!file) return;

                        if (!file.name.endsWith('.db')) {
                            showNotification('Please select a valid database file (.db extension)', 'error');
                            return;
                        }

                        if (confirm(' WARNING: This will replace ALL current data with the backup data. This action cannot be undone.\n\nAre you sure you want to upload and restore this backup?')) {
                            await uploadAndRestoreBackup(file);
                        }

                        e.target.value = '';
                    });
                }
            }

            async function uploadAndRestoreBackup(file) {
                const formData = new FormData();
                formData.append('backupFile', file);

                try {
                    setLoading(restoreBackupBtn, true);

                    const response = await fetch('/api/backups/upload-restore', {
                        method: 'POST',
                        body: formData,
                        credentials: 'include'
                    });

                    const result = await response.json();

                    if (result && result.success) {
                        showNotification('Backup uploaded and restored successfully! The system will reload in 3 seconds.', 'success');
                        setTimeout(() => {
                            location.reload();
                        }, 3000);
                    } else {
                        showNotification(result?.error || 'Failed to upload and restore backup', 'error');
                    }
                } catch (error) {
                    showNotification('Upload failed: ' + error.message, 'error');
                } finally {
                    setLoading(restoreBackupBtn, false);
                }
            }

            // Tab navigation
            function showTab(tabId) {
                tabContents.forEach(tab => {
                    tab.classList.remove('active');
                });

                tabLinks.forEach(link => {
                    link.classList.remove('active');
                });

                document.getElementById(tabId).classList.add('active');

                document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');

                // Load data for the selected tab
                switch (tabId) {
                    case 'dashboard':
                        loadDashboardStats();
                        loadLeads();
                        break;
                    case 'leads':
                        loadLeads();
                        break;
                    case 'clients':
                        loadClients();
                        break;
                    case 'projects':
                        loadProjects();
                        break;
                    case 'tasks':
                        loadTasks();
                        break;
                    case 'tickets':
                        loadTickets();
                        break;
                    case 'users':
                        loadUsers();
                        break;
                    case 'security':
                        loadVulnerabilities();
                        loadIncidents();
                        loadAlerts();
                        break;
                    case 'teamChat':
                        loadChatMessages();
                        break;
                    case 'systemLogs':
                        loadSystemLogs();
                        break;
                    case 'backup':
                        loadBackups();
                        break;
                }
            }

            // Initialize the application
            async function initializeApp() {
                // Load initial data
                await loadDashboardStats();
                await loadLeads();
                await loadClients();
                await loadProjects();
                await loadTasks();
                await loadTickets();
                await loadUsers();
                await loadVulnerabilities();
                await loadIncidents();
                await loadAlerts();
                await loadChatMessages();
                await loadSystemLogs();
                await loadBackups();
                await loadProfile();

                // Setup profile picture upload
                setupProfilePictureUpload();

                // Setup backup upload
                setupBackupUpload();

                // Setup notification system
                setupNotificationSystem();

                // Initialize charts
                initializeCharts();

                showNotification('Application loaded successfully!', 'success');
            }

            function setupNotificationSystem() {
                // Request notification permission
                if ('Notification' in window) {
                    Notification.requestPermission();
                }

                // Notification dropdown toggle
                notificationBtn.addEventListener('click', () => {
                    notificationDropdown.classList.toggle('hidden');
                });

                // Clear all notifications
                clearNotifications.addEventListener('click', () => {
                    clearAllNotifications();
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    if (!notificationBtn.contains(e.target) && !notificationDropdown.contains(e.target)) {
                        notificationDropdown.classList.add('hidden');
                    }
                });

                // Add some sample notifications
                addNotification('Welcome to Cyber Nytronix CRM', 'Your dashboard is ready to use.', 'success');
                addNotification('System Update', 'All systems are running smoothly.', 'info');
            }

            function initializeCharts() {
                // Leads by Status Chart
                const leadsCtx = document.getElementById('leadsChart').getContext('2d');
                const leadsData = {
                    labels: ['New', 'Contacted', 'Qualified', 'Proposal', 'Closed'],
                    datasets: [{
                        label: 'Leads by Status',
                        data: [12, 19, 8, 5, 3],
                        backgroundColor: [
                            '#3b82f6',
                            '#8b5cf6',
                            '#10b981',
                            '#f59e0b',
                            '#6b7280'
                        ],
                        borderWidth: 1
                    }]
                };

                new Chart(leadsCtx, {
                    type: 'doughnut',
                    data: leadsData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });

                // Revenue Trend Chart
                const revenueCtx = document.getElementById('revenueChart').getContext('2d');
                const revenueData = {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Monthly Revenue',
                        data: [12000, 19000, 15000, 25000, 22000, 30000],
                        backgroundColor: 'rgba(34, 197, 94, 0.2)',
                        borderColor: 'rgba(34, 197, 94, 1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }]
                };

                new Chart(revenueCtx, {
                    type: 'line',
                    data: revenueData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function (value) {
                                        return '$' + value.toLocaleString();
                                    }
                                }
                            }
                        }
                    }
                });

                // Revenue Analytics Chart
                const revenueAnalyticsCtx = document.getElementById('revenueAnalyticsChart').getContext('2d');
                const revenueAnalyticsData = {
                    labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                    datasets: [{
                        label: 'Revenue',
                        data: [45000, 52000, 48000, 61000],
                        backgroundColor: 'rgba(59, 130, 246, 0.5)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 2
                    }]
                };

                new Chart(revenueAnalyticsCtx, {
                    type: 'bar',
                    data: revenueAnalyticsData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function (value) {
                                        return '$' + value.toLocaleString();
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Event Listeners
            document.addEventListener('DOMContentLoaded', function () {
                // Check session on page load
                checkSession();

                // Login form
                loginForm.addEventListener('submit', function (e) {
                    e.preventDefault();
                    const email = document.getElementById('email').value;
                    const password = document.getElementById('password').value;
                    login(email, password);
                });

                // Sidebar toggle
                toggleSidebar.addEventListener('click', function () {
                    sidebar.classList.toggle('open');
                });

                // Tab navigation
                tabLinks.forEach(link => {
                    link.addEventListener('click', function (e) {
                        e.preventDefault();
                        const tabId = this.getAttribute('data-tab');
                        showTab(tabId);

                        // Close sidebar on mobile after selecting a tab
                        if (window.innerWidth <= 768) {
                            sidebar.classList.remove('open');
                        }
                    });
                });

                // Profile dropdown
                profileDropdownBtn.addEventListener('click', function () {
                    profileDropdown.classList.toggle('hidden');
                });

                // Logout
                logoutLink.addEventListener('click', function (e) {
                    e.preventDefault();
                    logout();
                });

                // Profile link
                document.getElementById('profileLink').addEventListener('click', function (e) {
                    e.preventDefault();
                    openModal('profileModal');
                });

                // Add lead
                addLeadBtn.addEventListener('click', function () {
                    openModal('addLeadModal');
                });

                addLeadForm.addEventListener('submit', function (e) {
                    e.preventDefault();
                    const leadData = {
                        name: document.getElementById('leadName').value,
                        company: document.getElementById('leadCompany').value,
                        email: document.getElementById('leadEmail').value,
                        phone: document.getElementById('leadPhone').value,
                        source: document.getElementById('leadSource').value,
                        status: document.getElementById('leadStatus').value,
                        priority: document.getElementById('leadPriority').value,
                        value: parseFloat(document.getElementById('leadValue').value),
                        notes: document.getElementById('leadNotes').value
                    };
                    addLead(leadData);
                });

                // Add client
                addClientBtn.addEventListener('click', function () {
                    openModal('addClientModal');
                });

                addClientForm.addEventListener('submit', function (e) {
                    e.preventDefault();
                    const clientData = {
                        name: document.getElementById('clientName').value,
                        company: document.getElementById('clientCompany').value,
                        email: document.getElementById('clientEmail').value,
                        phone: document.getElementById('clientPhone').value,
                        address: document.getElementById('clientAddress').value,
                        website: document.getElementById('clientWebsite').value,
                        industry: document.getElementById('clientIndustry').value,
                        services: document.getElementById('clientServices').value,
                        contract_value: parseFloat(document.getElementById('clientContractValue').value),
                        status: document.getElementById('clientStatus').value,
                        notes: document.getElementById('clientNotes').value
                    };
                    addClient(clientData);
                });

                // Add project
                addProjectBtn.addEventListener('click', function () {
                    openModal('addProjectModal');
                });

                addProjectForm.addEventListener('submit', function (e) {
                    e.preventDefault();
                    const projectData = {
                        name: document.getElementById('projectName').value,
                        description: document.getElementById('projectDescription').value,
                        client_id: document.getElementById('projectClient').value,
                        status: document.getElementById('projectStatus').value,
                        priority: document.getElementById('projectPriority').value,
                        assigned_to: document.getElementById('projectAssignedTo').value,
                        start_date: document.getElementById('projectStartDate').value,
                        end_date: document.getElementById('projectEndDate').value,
                        budget: parseFloat(document.getElementById('projectBudget').value),
                        progress: parseInt(document.getElementById('projectProgress').value)
                    };
                    addProject(projectData);
                });

                // Add task
                addTaskBtn.addEventListener('click', function () {
                    openModal('addTaskModal');
                });

                addTaskForm.addEventListener('submit', function (e) {
                    e.preventDefault();
                    const taskData = {
                        title: document.getElementById('taskTitle').value,
                        description: document.getElementById('taskDescription').value,
                        project_id: document.getElementById('taskProject').value,
                        assigned_to: document.getElementById('taskAssignedTo').value,
                        status: document.getElementById('taskStatus').value,
                        priority: document.getElementById('taskPriority').value,
                        due_date: document.getElementById('taskDueDate').value,
                        estimated_hours: parseFloat(document.getElementById('taskEstimatedHours').value)
                    };
                    addTask(taskData);
                });

                // Add ticket
                addTicketBtn.addEventListener('click', function () {
                    openModal('addTicketModal');
                });

                addTicketForm.addEventListener('submit', function (e) {
                    e.preventDefault();
                    const ticketData = {
                        title: document.getElementById('ticketTitle').value,
                        description: document.getElementById('ticketDescription').value,
                        client_id: document.getElementById('ticketClient').value,
                        type: document.getElementById('ticketType').value,
                        priority: document.getElementById('ticketPriority').value,
                        status: document.getElementById('ticketStatus').value,
                        assigned_to: document.getElementById('ticketAssignedTo').value
                    };
                    addTicket(ticketData);
                });

                // Add user
                addUserBtn.addEventListener('click', function () {
                    openModal('addUserModal');
                });

                addUserForm.addEventListener('submit', function (e) {
                    e.preventDefault();
                    const userData = {
                        name: document.getElementById('userNameInput').value,
                        email: document.getElementById('userEmail').value,
                        password: document.getElementById('userPassword').value,
                        role: document.getElementById('userRoleSelect').value,
                        department: document.getElementById('userDepartment').value,
                        position: document.getElementById('userPosition').value,
                        phone: document.getElementById('userPhone').value,
                        status: document.getElementById('userStatus').value
                    };
                    addUser(userData);
                });

                // Add vulnerability
                addVulnerabilityBtn.addEventListener('click', function () {
                    openModal('addVulnerabilityModal');
                });

                addVulnerabilityForm.addEventListener('submit', function (e) {
                    e.preventDefault();
                    const vulnerabilityData = {
                        title: document.getElementById('vulnerabilityTitle').value,
                        description: document.getElementById('vulnerabilityDescription').value,
                        severity: document.getElementById('vulnerabilitySeverity').value,
                        status: document.getElementById('vulnerabilityStatus').value,
                        project_id: document.getElementById('vulnerabilityProject').value,
                        assigned_to: document.getElementById('vulnerabilityAssignedTo').value,
                        cvss_score: parseFloat(document.getElementById('vulnerabilityCvssScore').value)
                    };
                    addVulnerability(vulnerabilityData);
                });

                // Add incident
                addIncidentBtn.addEventListener('click', function () {
                    openModal('addIncidentModal');
                });

                addIncidentForm.addEventListener('submit', function (e) {
                    e.preventDefault();
                    const incidentData = {
                        title: document.getElementById('incidentTitle').value,
                        description: document.getElementById('incidentDescription').value,
                        severity: document.getElementById('incidentSeverity').value,
                        status: document.getElementById('incidentStatus').value,
                        client_id: document.getElementById('incidentClient').value,
                        assigned_to: document.getElementById('incidentAssignedTo').value
                    };
                    addIncident(incidentData);
                });

                // Edit lead form
                document.getElementById('editLeadForm').addEventListener('submit', function (e) {
                    e.preventDefault();
                    const leadData = {
                        id: document.getElementById('editLeadId').value,
                        name: document.getElementById('editLeadName').value,
                        company: document.getElementById('editLeadCompany').value,
                        email: document.getElementById('editLeadEmail').value,
                        phone: document.getElementById('editLeadPhone').value,
                        source: document.getElementById('editLeadSource').value,
                        status: document.getElementById('editLeadStatus').value,
                        priority: document.getElementById('editLeadPriority').value,
                        value: parseFloat(document.getElementById('editLeadValue').value),
                        notes: document.getElementById('editLeadNotes').value
                    };
                    updateLead(leadData);
                });

                // Edit client form
                document.getElementById('editClientForm').addEventListener('submit', function (e) {
                    e.preventDefault();
                    const clientData = {
                        id: document.getElementById('editClientId').value,
                        name: document.getElementById('editClientName').value,
                        company: document.getElementById('editClientCompany').value,
                        email: document.getElementById('editClientEmail').value,
                        phone: document.getElementById('editClientPhone').value,
                        address: document.getElementById('editClientAddress').value,
                        website: document.getElementById('editClientWebsite').value,
                        industry: document.getElementById('editClientIndustry').value,
                        services: document.getElementById('editClientServices').value,
                        contract_value: parseFloat(document.getElementById('editClientContractValue').value),
                        status: document.getElementById('editClientStatus').value,
                        notes: document.getElementById('editClientNotes').value
                    };
                    updateClient(clientData);
                });

                // Edit project form
                document.getElementById('editProjectForm').addEventListener('submit', function (e) {
                    e.preventDefault();
                    const projectData = {
                        id: document.getElementById('editProjectId').value,
                        name: document.getElementById('editProjectName').value,
                        description: document.getElementById('editProjectDescription').value,
                        client_id: document.getElementById('editProjectClient').value,
                        status: document.getElementById('editProjectStatus').value,
                        priority: document.getElementById('editProjectPriority').value,
                        assigned_to: document.getElementById('editProjectAssignedTo').value,
                        start_date: document.getElementById('editProjectStartDate').value,
                        end_date: document.getElementById('editProjectEndDate').value,
                        budget: parseFloat(document.getElementById('editProjectBudget').value),
                        progress: parseInt(document.getElementById('editProjectProgress').value)
                    };
                    updateProject(projectData);
                });

                // Edit task form
                document.getElementById('editTaskForm').addEventListener('submit', function (e) {
                    e.preventDefault();
                    const taskData = {
                        id: document.getElementById('editTaskId').value,
                        title: document.getElementById('editTaskTitle').value,
                        description: document.getElementById('editTaskDescription').value,
                        project_id: document.getElementById('editTaskProject').value,
                        assigned_to: document.getElementById('editTaskAssignedTo').value,
                        status: document.getElementById('editTaskStatus').value,
                        priority: document.getElementById('editTaskPriority').value,
                        due_date: document.getElementById('editTaskDueDate').value,
                        estimated_hours: parseFloat(document.getElementById('editTaskEstimatedHours').value)
                    };
                    updateTask(taskData);
                });

                // Edit ticket form
                document.getElementById('editTicketForm').addEventListener('submit', function (e) {
                    e.preventDefault();
                    const ticketData = {
                        id: document.getElementById('editTicketId').value,
                        title: document.getElementById('editTicketTitle').value,
                        description: document.getElementById('editTicketDescription').value,
                        client_id: document.getElementById('editTicketClient').value,
                        type: document.getElementById('editTicketType').value,
                        priority: document.getElementById('editTicketPriority').value,
                        status: document.getElementById('editTicketStatus').value,
                        assigned_to: document.getElementById('editTicketAssignedTo').value
                    };
                    updateTicket(ticketData);
                });

                // Edit user form
                document.getElementById('editUserForm').addEventListener('submit', function (e) {
                    e.preventDefault();
                    const userData = {
                        id: document.getElementById('editUserId').value,
                        name: document.getElementById('editUserName').value,
                        email: document.getElementById('editUserEmail').value,
                        role: document.getElementById('editUserRole').value,
                        department: document.getElementById('editUserDepartment').value,
                        position: document.getElementById('editUserPosition').value,
                        phone: document.getElementById('editUserPhone').value,
                        status: document.getElementById('editUserStatus').value
                    };
                    updateUser(userData);
                });

                // Reset password form
                document.getElementById('resetPasswordForm').addEventListener('submit', function (e) {
                    e.preventDefault();
                    const newPassword = document.getElementById('resetPasswordNewPassword').value;
                    const confirmPassword = document.getElementById('resetPasswordConfirmPassword').value;
                    
                    if (newPassword !== confirmPassword) {
                        showNotification('Passwords do not match!', 'error');
                        return;
                    }

                    const passwordData = {
                        userId: document.getElementById('resetPasswordUserId').value,
                        newPassword: newPassword
                    };
                    resetPassword(passwordData);
                });

                // Profile form
                document.getElementById('profileForm').addEventListener('submit', function (e) {
                    e.preventDefault();
                    const profileData = {
                        name: document.getElementById('profileFullName').value,
                        email: document.getElementById('profileEmailInput').value,
                        phone: document.getElementById('profilePhone').value,
                        department: document.getElementById('profileDepartment').value,
                        position: document.getElementById('profilePosition').value
                    };
                    updateProfile(profileData);
                });

                // Change password form
                document.getElementById('changePasswordForm').addEventListener('submit', function (e) {
                    e.preventDefault();
                    const passwordData = {
                        current_password: document.getElementById('currentPassword').value,
                        new_password: document.getElementById('newPassword').value,
                        confirm_password: document.getElementById('confirmPassword').value
                    };
                    changePassword(passwordData);
                });

                // Change password button
                document.getElementById('changePasswordBtn').addEventListener('click', function () {
                    closeModal('profileModal');
                    openModal('changePasswordModal');
                });

                // Search leads
                searchLeads.addEventListener('input', renderLeadsTable);
                statusFilter.addEventListener('change', renderLeadsTable);

                // Delete items
                document.addEventListener('click', function (e) {
                    if (e.target.classList.contains('delete-item') || e.target.closest('.delete-item')) {
                        const button = e.target.classList.contains('delete-item') ? e.target : e.target.closest('.delete-item');
                        const itemId = button.dataset.id;
                        const itemType = button.dataset.type;
                        const itemName = button.dataset.name;
                        deleteItem(itemId, itemType, itemName);
                    }
                });

                // Send chat message
                sendMessageBtn.addEventListener('click', function () {
                    const message = messageInput.value.trim();
                    if (message) {
                        sendMessage(message);
                    }
                });

                messageInput.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        const message = messageInput.value.trim();
                        if (message) {
                            sendMessage(message);
                        }
                    }
                });

                // Refresh logs
                refreshLogsBtn.addEventListener('click', loadSystemLogs);

                // Create backup
                createBackupBtn.addEventListener('click', createBackup);

                // Restore backup
                restoreBackupBtn.addEventListener('click', restoreBackup);

                // Close dropdowns when clicking outside
                document.addEventListener('click', function (e) {
                    if (!profileDropdownBtn.contains(e.target)) {
                        profileDropdown.classList.add('hidden');
                    }
                });

                // Auto-refresh data every 30 seconds
                setInterval(() => {
                    const currentTab = document.querySelector('.tab-content.active').id;
                    switch (currentTab) {
                        case 'dashboard':
                            loadDashboardStats();
                            break;
                        case 'leads':
                            loadLeads();
                            break;
                        case 'clients':
                            loadClients();
                            break;
                        case 'projects':
                            loadProjects();
                            break;
                        case 'tasks':
                            loadTasks();
                            break;
                        case 'tickets':
                            loadTickets();
                            break;
                        case 'users':
                            loadUsers();
                            break;
                        case 'security':
                            loadVulnerabilities();
                            loadIncidents();
                            loadAlerts();
                            break;
                        case 'teamChat':
                            loadChatMessages();
                            break;
                        case 'systemLogs':
                            loadSystemLogs();
                            break;
                        case 'backup':
                            loadBackups();
                            break;
                    }
                }, 30000);
            });
        </script>
</body>


</html>
